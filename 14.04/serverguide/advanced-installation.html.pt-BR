<!DOCTYPE html>
<html lang=pt-BR>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Instalação avançada</title>
<link rel="stylesheet" type="text/css" href="pt_BR.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="https://partners.ubuntu.com">Partners</a></li>
<li><a href="https://www.ubuntu.com/support/community-support">Support</a></li>
<li><a href="https://community.ubuntu.com">Community</a></li>
<li><a href="https://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="https://community.ubuntu.com/t/contribute/26">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../14.04" class="trail">Ubuntu 14.04</a> » <a class="trail" href="index.html" title="Guia para servidores Ubuntu">Guia para servidores Ubuntu</a> » <a class="trail" href="installation.html" title="Instalação">Instalação</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="installing-upgrading.html" title="Atualizando">Anterior</a><a class="nextlinks-next" href="kernel-crash-dump.html" title="Kernel Crash Dump">Próximo</a>
</div>
<div class="hgroup"><h1 class="title">Instalação avançada</h1></div>
<div class="region">
<div class="contents"></div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="advanced-installation.html#software-raid" title="RAID via software">RAID via software</a></li>
<li class="links"><a class="xref" href="advanced-installation.html#lvm" title="Gerenciador de volume lógico (LVM)">Gerenciador de volume lógico (LVM)</a></li>
</ul></div>
<div class="sect2 sect" id="software-raid"><div class="inner">
<div class="hgroup"><h2 class="title">RAID via software</h2></div>
<div class="region">
<div class="contents">
<p class="para">
        Redundant Array of Independent Disks "RAID" is a method of using multiple disks to provide different balances of
        increasing data reliability and/or increasing input/output performance, depending on the RAID level being used.
        RAID is implemented in either software 
        (where the operating system knows about both drives and actively maintains both of them) or hardware 
        (where a special controller makes the OS think there's only one drive and maintains the drives 'invisibly').
        </p>
<p class="para">O software RAID incluído com as versões atuais do Linux (e Ubuntu) é baseado no driver <span class="app application">'mdadm'</span> e funciona muito bem, melhor até que muitos chamados controladores RAID por 'hardware'. Esta seção guiará você através da instalação do Ubuntu Server Edition usando duas partições RAID1 em dois discos físicos distintos, um para <span class="em emphasis">/</span> e outro para <span class="em emphasis">swap</span>.</p>
</div>
<div class="sect3 sect" id="raid-partitioning"><div class="inner">
<div class="hgroup"><h3 class="title">Particionando</h3></div>
<div class="region"><div class="contents">
<p class="para">Siga os passos da instalação até que você chegue no passo <span class="em emphasis">Particionar discos</span> e então:</p>
<div class="steps"><div class="inner"><ol class="steps">
<li class="steps">
 
              <p class="para">Selecione <span class="em emphasis">Manual</span> como o método de particionamento.</p>

            </li>
<li class="steps">
 
              <p class="para">Selecione o primeiro disco rígido, e aceite para <span class="em emphasis">"Criar uma nova tabela de partição neste dispositivo?"</span>.</p>

              <p class="para">Repetir este passo para cada disco rígido que deseja adicionar à matriz RAID.</p>

            </li>
<li class="steps">
 
              <p class="para">Selecione o <span class="em emphasis">"Espaço Livre"</span> no primeiro disco rígido e então selecione <span class="em emphasis">"Criar uma nova partição"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Em seguida, selecione o <span class="em emphasis">Tamanho</span> da partição. Esta será a partição de <span class="em emphasis">swap</span>. Uma regra geral para o tamanho da partição de swap é duas vezes o tamanho da RAM. Entre com o tamanho da partição, e escolha <span class="em emphasis">Primária</span>, e então <span class="em emphasis">Início</span>.</p>

              <div class="note" title="Nota"><div class="inner"><div class="region"><div class="contents">
                <p class="para">
                A swap partition size of twice the available RAM capacity may not always be desirable, especially on systems with large amounts of RAM.
                Calculating the swap partition size for servers is highly dependent on how the system is going to be used.
                </p>
              </div></div></div></div>

            </li>
<li class="steps">
 
              <p class="para">Selecione a linha do topo <span class="em emphasis">"Use como:"</span>. Por padrão este é o <span class="em emphasis">"Ext4 journaling file system"</span>, altere para <span class="em emphasis">"volume físico para RAID"</span> e então <span class="em emphasis">"Terminado o ajuste da partição"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Para a partição <span class="em emphasis">/</span> selecione <span class="em emphasis">"Espaço Livre"</span> no primeiro disco e então <span class="em emphasis">"Criar uma nova partição"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Use o restante do espaço livre no disco e escolha <span class="em emphasis">Continuar</span>, e então <span class="em emphasis">Primária</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Com a partição de swap, selecione a linha do topo <span class="em emphasis">"Use como:"</span> alterando-a para <span class="em emphasis">"volume físico para RAID"</span>. Selecione também a linha <span class="em emphasis">"Flag bootável:"</span> para alterar o seu valor para <span class="em emphasis">"on"</span>. Então, escolha <span class="em emphasis">"Terminado o ajuste da partição"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Repita os passos de três a oito para outros discos e partições.</p>

            </li>
</ol></div></div>
</div></div>
</div></div>
<div class="sect3 sect" id="raid-configuration"><div class="inner">
<div class="hgroup"><h3 class="title">Configuração de RAID</h3></div>
<div class="region"><div class="contents">
<p class="para">Uma vez concluída a configuração das partições, os arranjos estão prontos para serem configurados:</p>
<div class="steps"><div class="inner"><ol class="steps">
<li class="steps">
 
              <p class="para">Voltando à página principal de "Particionar Discos", selecione <span class="em emphasis">"Configurar RAID por software"</span> logo no topo.</p>

            </li>
<li class="steps">
 
              <p class="para">Clique em <span class="em emphasis">"sim"</span> para gravar as alterações no disco.</p>

            </li>
<li class="steps">
 
              <p class="para">Escolha <span class="em emphasis">"Criar dispositivo MD"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Para este exemplo, selecione <span class="em emphasis">"RAID1"</span>, mas se você está usando uma configuração diferente escolha o tipo apropriado (RAID0 RAID1 RAID5).</p>

              <div class="note" title="Nota"><div class="inner"><div class="region"><div class="contents">
                <p class="para">Para poder usar <span class="em emphasis">RAID5</span>, você precisa ao menos de <span class="em emphasis">três</span> unidades. Usando RAID0 ou RAID1, apenas <span class="em emphasis">duas</span> unidades são requeridas.</p>
              </div></div></div></div>

            </li>
<li class="steps">
 
              <p class="para">Digite o número de dispositivos ativos <span class="em emphasis">"2"</span>, ou a quantidade de discos rígidos que você tem para a matriz. Então clique em <span class="em emphasis">"Continuar"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">A seguir, digite o número de dispositivos sobressalentes <span class="em emphasis">"0"</span> por padrão, então clique em <span class="em emphasis">"Continuar"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Escolha quais partições usar. Elas costumam ser sda1, sdb1, sdc1, etc. Os números normalmente vão combinar e as diferentes letras corresponder a diferentes discos rígidos.</p>

              <p class="para">Para a partição <span class="em emphasis">swap</span> escolha <span class="em emphasis">sda1</span> e <span class="em emphasis">sdb1</span>. Selecione <span class="em emphasis">"Continuar"</span> para ir ao próximo passo.</p>

            </li>
<li class="steps">
 
              <p class="para">Repita os passos de <span class="em emphasis">três</span> e <span class="em emphasis">sete</span> para a partição <span class="em emphasis">/</span> escolhendo <span class="em emphasis">sda2</span> e <span class="em emphasis">sdb2</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Uma vez que tenha terminado, Clique em <span class="em emphasis">"Finalizar"</span>.</p>

            </li>
</ol></div></div>
</div></div>
</div></div>
<div class="sect3 sect" id="raid-formatting"><div class="inner">
<div class="hgroup"><h3 class="title">Formatando</h3></div>
<div class="region"><div class="contents">
<p class="para">Deve agora haver uma lista de discos rígidos e dispositivos RAID. O próximo passo é formatar e definir o ponto de montagem para os dispositivos RAID. Trate o dispositivo RAID como um disco rígido local, formate e monte como se fosse tal.</p>
<div class="steps"><div class="inner"><ol class="steps">
<li class="steps">
 
              <p class="para">Selecione <span class="em emphasis">"#1"</span> sob a partição <span class="em emphasis">"RAID1 device #0"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Escolha <span class="em emphasis">"Usar como:"</span>. Então selecione <span class="em emphasis">"área de troca"</span>, então <span class="em emphasis">"Configuração da partição concluída"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Em seguida, selecione <span class="em emphasis">"#1"</span> sob a sob a partição <span class="em emphasis">"RAID1 device #1"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Escolha <span class="em emphasis">"Use como:"</span>. Então selecione <span class="em emphasis">"Ext4 journaling file system"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Então selecione o <span class="em emphasis">"Ponto de montagem"</span> e escolha <span class="em emphasis">"/ - a raíz do sistema de arquivo"</span>. Altere as outras opções de forma apropriada, então selecione <span class="em emphasis">"Configuração da partição concluída"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Finalmente selecione <span class="em emphasis">"Finalizar particionamento e gravar mudanças no disco"</span>.</p>

            </li>
</ol></div></div>
<p class="para">Se você escolher colocar a partição raiz em uma matriz RAID, o instalador vai então perguntar se você gostaria de iniciar com o estato de <span class="em emphasis">degradado</span>. Veja <a class="xref" href="advanced-installation.html#raid-degraded" title="RAID degradado">RAID degradado</a> para mais detalhes.</p>
<p class="para">O processo de instalação vai então continuar normalmente.</p>
</div></div>
</div></div>
<div class="sect3 sect" id="raid-degraded"><div class="inner">
<div class="hgroup"><h3 class="title">RAID degradado</h3></div>
<div class="region"><div class="contents">
<p class="para">Em algum ponto do ciclo de vida de um computador um evento de falha no disco pode ocorrer. Quando isso acontece, usando RAID por software, o sistema operacional colocará a matriz em um estado que é conhecido como <span class="em emphasis">degradado</span>.</p>
<p class="para">Se a matriz se degradou, devido à chance de corrupção de dados, a Edição de Servidor Ubuntu vai inicializar com o <span class="em emphasis">initramfs</span> após trinta segundos. Uma vez que o initramfs tenha iniciado, há um aviso de quinze segundos dando-lhe a opção para avançar e iniciar o sistema ou tentar uma recuperação manual. Inicializar com o prompt do initramfs pode ou não ser o comportamento desejado, especialmente se a máquina está em um local remoto. Inicializar por uma matriz degradada pode ser configurado de diversas maneiras:</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">

              <p class="para">O utilitário <span class="app application">dpkg-reconfigure</span> pode ser usado para configurar o comportamento padrão e, durante o processo, você será questionado sobre configurações adicionais relacionadas à matriz com perguntas sobre monitoramento, alertas por email, etc. Para reconfigurar o <span class="app application">mdadm, digite o seguinte:</span></p>

<div class="screen"><pre class="contents "><span class="cmd command">sudo dpkg-reconfigure mdadm</span>
</pre></div>

             </li>
<li class="list itemizedlist">

              <p class="para">O processo <span class="cmd command">dpkg-reconfigure mdadm</span> mudará o arquivo de configuração <span class="file filename">/etc/initramfs-tools/conf.d/mdadm</span>. O arquivo tem a vantagem de ser capaz de pré-configurar o comportamento do sistema e também pode ser editado manualmente:</p>

<div class="code"><pre class="contents ">BOOT_DEGRADED=true
</pre></div>

          <div class="note" title="Nota"><div class="inner"><div class="region"><div class="contents">
            <p class="para">O arquivo de configuração pode ser sobrescrito usando um argumento de Kernel.</p>
          </div></div></div></div>          

            </li>
<li class="list itemizedlist">
    
              <p class="para">Usar um argumento de Kernel permitirá ao sistema iniciar também de um array degradado.</p>

              <div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
                  <p class="para">Quando o servidor estiver inicializando tecle <span class="key keycap"><kbd>Shift</kbd></span> para abrir o menu do <span class="app application">Grub</span>.</p>
                </li>
<li class="list itemizedlist">
                  <p class="para">Tecle <span class="key keycap"><kbd>e</kbd></span> para editar as opções de comando do seu kernel.</p>
                </li>
<li class="list itemizedlist">
                  <p class="para">Tecle a <span class="key keycap"><kbd>seta para baixo</kbd></span> para marcar a linha do kernel.</p>
                </li>
<li class="list itemizedlist">
                  <p class="para">Adicione <span class="em emphasis">"bootdegraded=true"</span> (sem as aspas) ao final da linha.</p>
                </li>
<li class="list itemizedlist">
                  <p class="para">Pressione <span class="keyseq keycombo"><span class="key keycap"><kbd>Ctrl</kbd></span>+<span class="key keycap"><kbd>x</kbd></span></span> para inicializar o sistema.</p>
                </li>
</ul></div>

            </li>
</ul></div>
<p class="para">Uma vez que o sistema tenha iniciado, você pode tanto reparar o array (veja <a class="xref" href="advanced-installation.html#raid-maintenance" title="Manutenção do RAID">Manutenção do RAID</a> para maiores detalhes), ou copiar dados importantes para outra máquina devido à maior falha de hardware.</p>
</div></div>
</div></div>
<div class="sect3 sect" id="raid-maintenance"><div class="inner">
<div class="hgroup"><h3 class="title">Manutenção do RAID</h3></div>
<div class="region"><div class="contents">
<p class="para">O utilitário <span class="app application">mdadm</span> pode ser usado para visualizar o estado de um array, adicionar discos a um array, remover discos, etc:</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
              <p class="para">Para visualizar o estado de um array, digite em um terminal:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo mdadm -D /dev/md0</span>
</pre></div>
            
              <p class="para">O <span class="em emphasis">-D</span> instrui o <span class="app application">mdadm</span> a mostrar informações <span class="em emphasis">detalhadas</span> sobre o dispositivo <span class="file filename">/dev/md0</span>. Substitua <span class="file filename">/dev/md0</span> pelo dispositivo RAID apropriado.</p>
            </li>
<li class="list itemizedlist">
              <p class="para">Para visualizar o estado de um disco em um array:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo mdadm -E /dev/sda1</span>
</pre></div>
              <p class="para">A saída é muito similar ao comando <span class="cmd command">mdadm -D</span>, ajuste <span class="file filename">/dev/sda1</span> para cada disco.</p>
            </li>
<li class="list itemizedlist">
              <p class="para">Se um disco falha e precisa ser removido de um array, digite:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo mdadm --remove /dev/md0 /dev/sda1</span>
</pre></div>
              <p class="para">Modifique <span class="file filename">/dev/md0</span> e <span class="file filename">/dev/sda1</span> para o dispositivo RAID e disco apropriados.</p>
            </li>
<li class="list itemizedlist">
              <p class="para">Similar a adicionar um novo disco:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo mdadm --add /dev/md0 /dev/sda1</span>
</pre></div>
            </li>
</ul></div>
<p class="para">Algumas vezes, um disco pode apresentar o estado de <span class="em emphasis">faulty</span> mesmo que não haja nada errado fisicamente com a unidade. Normalmente não vale à pena remover a unidade da matriz e então adicioná-lo novamente. Isto fará com que a unidade sincronize-se novamente com o array. Se a unidade não sincronizar com o array, é uma boa indicação de falha no hardware.</p>
<p class="para">O arquivo <span class="file filename">/proc/mdstat</span> também contém informações importantes sobre os dispositivos RAID do sistema.</p>
<div class="screen"><pre class="contents "><span class="cmd command">cat /proc/mdstat</span>
<span class="output computeroutput">Personalidades : [linear] [multipath] [raid0] [raid1] [raid6] [raid5] [raid4] [raid10] 
md0 : active raid1 sda1[0] sdb1[1]
      10016384 blocks [2/2] [UU]
      
dispositivos não usados: &lt;nenhum&gt;</span>
</pre></div>
<p class="para">O seguinte comando é ótimo para observar o estado de uma unidade em sincronia.</p>
<div class="screen"><pre class="contents "><span class="cmd command">watch -n1 cat /proc/mdstat</span>
</pre></div>
<p class="para">Pressione <span class="em emphasis">Ctrl+c</span> para parar  o comando <span class="app application">watch</span>.</p>
<p class="para">Se você precisa substituir uma unidade com defeito, depois da unidade ter sido trocada e sincronizada, o <span class="app application">grub</span> precisará ser instalado. Para instalar o <span class="app application">grub</span> na nova unidade, digite o seguinte:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo grub-install /dev/md0</span>
</pre></div>
<p class="para">Substitua <span class="file filename">/dev/md0</span> com nome de dispositivo de matriz apropriado.</p>
</div></div>
</div></div>
<div class="sect3 sect" id="raid-resources"><div class="inner">
<div class="hgroup"><h3 class="title">Recursos</h3></div>
<div class="region"><div class="contents">
<p class="para">O tópico sobre matriz RAID é bem complexo devido à superabundância de modos que o RAID pode ser configurado. Por favor veja os seguintes links para mais informações:</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
              <p class="para"><a href="https://help.ubuntu.com/community/Installation#raid" class="ulink" title="https://help.ubuntu.com/community/Installation#raid">Artigos sobre RAID no Wiki Ubuntu</a>.</p>
            </li>
<li class="list itemizedlist">
              <p class="para">
              <a href="http://www.faqs.org/docs/Linux-HOWTO/Software-RAID-HOWTO.html" class="ulink" title="http://www.faqs.org/docs/Linux-HOWTO/Software-RAID-HOWTO.html">Software RAID COMO FAZER</a>
              </p>
            </li>
<li class="list itemizedlist">
              <p class="para">
              <a href="http://oreilly.com/catalog/9781565927308/" class="ulink" title="http://oreilly.com/catalog/9781565927308/">Gerenciando RAID no Linux</a>
              </p>
            </li>
</ul></div>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="lvm"><div class="inner">
<div class="hgroup"><h2 class="title">Gerenciador de volume lógico (LVM)</h2></div>
<div class="region">
<div class="contents"><p class="para">Gerenciador de volume lógico, ou <span class="em emphasis">LVM</span>, permite aos administradores criar volumes <span class="em emphasis">lógicos</span> envolvendo um ou mais discos físicos. Volumes LVM podem ser criados tanto sobre partições RAID com sobre partições comuns dentro de um único disco. Volumes podem também ser estendidos, dando grande flexibilidade para sistemas que requerem mudanças.</p></div>
<div class="sect3 sect" id="lvm-overview"><div class="inner">
<div class="hgroup"><h3 class="title">Visão geral</h3></div>
<div class="region"><div class="contents">
<p class="para">Um efeito colateral do poder e flexibilidade do LVM é o grande grau de complexidade. Antes de avançar no processo de instalação, é melhor familiarizar-se com alguns termos.</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
              <p class="para">
              <span class="em emphasis">Physical Volume (PV):</span> physical hard disk, disk partition or software RAID partition
              formatted as LVM PV.
              </p>
            </li>
<li class="list itemizedlist">
              <p class="para">
              <span class="em emphasis">Volume Group (VG):</span> is made from one or more physical volumes. A VG can can be
              extended by adding more PVs. A VG is like a virtual disk drive, from which one or more logical volumes are carved.
              </p>
            </li>
<li class="list itemizedlist">
              <p class="para">
              <span class="em emphasis">Logical Volume (LV):</span> is similar to a partition in a non-LVM system. A LV is formatted
              with the desired file system (EXT3, XFS, JFS, etc), it is then available for mounting and data storage.
              </p>
            </li>
</ul></div>
</div></div>
</div></div>
<div class="sect3 sect" id="lvm-installation"><div class="inner">
<div class="hgroup"><h3 class="title">Instalação</h3></div>
<div class="region"><div class="contents">
<p class="para">Como um exemplo, esta seção cobre a instalação do Ubuntu Server Edition com o <span class="file filename">/srv</span> montado sobre um volume LVM. Durante a instalação inicial apenas um Volume Físico (VF) será parte do Grupo de Volume (GV). Outro VF será adicionado após a instalação para demonstrar como um GV pode ser estendido.</p>
<p class="para">Existem diversas opções para instalação de LVM, <span class="em emphasis">"Guiado - usar o disco inteiro e configurar LVM"</span> que permitirá também defineir a porção do espaço disponível para LVM, <span class="em emphasis">"Guiado - usar tudo e configurar LVM criptografado"</span>, ou <span class="em emphasis">Manualmente</span> configurar as partições e configurar o LVM. A única maneira de configurar um sistema tanto com LVM quanto com partições comuns, durante a instalação, é usando a abordagem manual.</p>
<div class="steps"><div class="inner"><ol class="steps">
<li class="steps">

              <p class="para">Siga os passos da instalação até que você chegue no passo <span class="em emphasis">Particionar discos</span> e então:</p>

            </li>
<li class="steps">
 
              <p class="para">Na tela <span class="em emphasis">"Particionar Discos</span> escolha <span class="em emphasis">"Manual"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Selecione o disco rígido e na tela seguinte escolha "sim" para <span class="em emphasis">"Criar uma nova tabela de partição vazia neste dispositivo"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Em seguida, criar partições padrão <span class="em emphasis">/boot</span>, <span class="em emphasis">swap</span>, e <span class="em emphasis">/</span> com o sistema de arquivo de sua preferência.</p>

            </li>
<li class="steps">
 
              <p class="para">Para o LVM <span class="em emphasis">/srv</span>, crie uma nova partição <span class="em emphasis">Lógica</span>. Então mude <span class="em emphasis">"Usar como"</span> para <span class="em emphasis">"volume físico para LVM"</span> então <span class="em emphasis">"Configuração da partição concluída"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Agora selecione <span class="em emphasis">"Configurar o gerenciador de volumes lógicos (LVM) </span> no topo, e selecione <span class="em emphasis">"Sim"</span> para gravar as mudanças no disco.</p>

            </li>
<li class="steps">
 
              <p class="para">Para a <span class="em emphasis">"ação de configuração do LVM"</span> na tela seguinte, escolha <span class="em emphasis">"Criar grupo de volume"</span>. Insira um nome para o GV tal como <span class="em emphasis">gv01</span>, ou algo mais descritivo. Após inserir um nome, selecione a partição configurada para LVM, e escolha <span class="em emphasis">"Continuar"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Volte para a tela <span class="em emphasis">"ação de configuração do LVM"</span>, selecione <span class="em emphasis">"Criar volume lógico"</span>. Selecione o mais recentemente criado grupo de volume, e insira um nome para o novo VL, por exemplo <span class="em emphasis">srv</span> uma vez que este é o ponto de montagem que se deseja. Então escolha um tamanho, que pode ser a partição toda já que ela pode ser sempre extendida mais tarde. Escolha <span class="em emphasis">"Terminar"</span> e você estará de volta na tela <span class="em emphasis">"Particionar Dicos"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Agora adicione um sistema de arquivos ao novo LVM. Selecione a partição em <span class="em emphasis">"LVM GV gv01, VL srv"</span>, ou qualquer outro nome que você tenha preferido, então escolha <span class="em emphasis">Usar como</span>. Configure um sistema de arquivo como normal selecionando <span class="em emphasis">/srv</span> como o ponto de montagem. Tendo feito isso, selecione <span class="em emphasis">"Configuração da partição concluída"</span>.</p>

            </li>
<li class="steps">
 
              <p class="para">Finalmente, selecione <span class="em emphasis">"FInalizar o particionamento e gravar as alterações no disco"  "</span>. Então confirme as alterações e continue com o resto da instalação.</p>

            </li>
</ol></div></div>
<p class="para">Existem alguns utilitários para visualizar informações sobre LVM:</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist"><p class="para"><span class="em emphasis">pvdisplay:</span> shows information about Physical Volumes.</p></li>
<li class="list itemizedlist"><p class="para"><span class="em emphasis">vgdisplay:</span> mostra informações sobre grupos de volume.</p></li>
<li class="list itemizedlist"><p class="para"><span class="em emphasis">lvdisplay:</span> shows information about Logical Volumes.</p></li>
</ul></div>
</div></div>
</div></div>
<div class="sect3 sect" id="lvm-extending"><div class="inner">
<div class="hgroup"><h3 class="title">Extendendo grupos de volume</h3></div>
<div class="region"><div class="contents">
<p class="para">
          Continuing with <span class="em emphasis">srv</span> as an LVM volume example, this section covers adding a second hard disk, creating
          a Physical Volume (PV), adding it to the volume group (VG), extending the logical volume <span class="file filename">srv</span>
          and finally extending the filesystem. This example assumes a second hard disk has been added to the system. In
          this example, this hard disk will be named <span class="file filename">/dev/sdb</span> and we will use the entire disk as a physical volume 
          (you could choose to create partitions and use them as different physical volumes)
          </p>
<div class="note note-warning" title="Aviso"><div class="inner"><div class="region"><div class="contents">
          <p class="para">
              Make sure you don't already have an existing <span class="file filename">/dev/sdb</span> before issuing the commands below. You could lose some data if you issue those commands on a non-empty disk. 
          </p>
        </div></div></div></div>
<div class="steps"><div class="inner"><ol class="steps">
<li class="steps">
 
              <p class="para">Primeiramente, crie o volume físico. Em um terminal, execute:</p>

                <div class="screen"><pre class="contents "><span class="cmd command">sudo pvcreate /dev/sdb</span>
                </pre></div>

            </li>
<li class="steps">

              <p class="para">Agora estenda o grupo de volume (VG)</p>

<div class="screen"><pre class="contents "><span class="cmd command">sudo vgextend vg01 /dev/sdb</span>
</pre></div>

            </li>
<li class="steps">

              <p class="para">Usar <span class="app application">vgdisplay</span> para buscar por extensões físicas livres - EF Livres / tamanho (o tamanho que você pode alocar). Assumiremos um tamanho disponível de 511 EF (equivalente a 2 GB com um tamanho de EF de 4 MB) e usaremos todo o espaço disponível. Use sua própria EF e/ou espaço disponível.</p>

              <p class="para">O Volume Lógico (LV) pode agora ser estendido por diferentes métodos. Veremos apenas como usar a EF para estender o VL.</p>

<div class="screen"><pre class="contents "><span class="cmd command">sudo lvextend /dev/vg01/srv -l +511</span>
</pre></div>

              <p class="para">A opção <span class="em emphasis">-l</span> permite o VL ser estendido usando EF. A opção <span class="em emphasis">-L</span> permite o VL ser estendido usando Meg, Gig, Tera etc bytes.</p>

            </li>
<li class="steps">
 
              <p class="para">Mesmo embora você seria capaz de <span class="em emphasis">expandir</span> um sistema de arquivos ext3 ou ext4 sem primeiro desmontá-los, pode se tornar uma prática adequada desmontar de qualquer forma e verificar o sistema de arquivos, de modo que você não tenha problemas no dia em que desejar reduzir um volume lógico (nesse caso é indispensável que seja desmontado primeiro).</p>

              <p class="para">Os comandos a seguir são para filesystems do tipo <span class="em emphasis">EXT3</span> ou <span class="em emphasis">EXT4</span>. Se você estiver usando um outro tipo de filesystem, procure por outros utilitários disponíveis.</p>

<div class="screen"><pre class="contents "><span class="cmd command">sudo umount /srv</span>
<span class="cmd command">sudo e2fsck -f /dev/vg01/srv</span>
</pre></div>

              <p class="para">A opção <span class="em emphasis">-f</span> do <span class="app application">e2fsck</span> força a checagem mesmo que o sistema pareça íntegro.</p>

            </li>
<li class="steps">
 
              <p class="para">Finalmente, redimensione o sistema de arquivo:</p>

<div class="screen"><pre class="contents "><span class="cmd command">sudo resize2fs /dev/vg01/srv</span>
</pre></div>

            </li>
<li class="steps">
 
              <p class="para">Agora monte a partição e verifique o seu tamanho.</p>

<div class="screen"><pre class="contents "><span class="cmd command">mount /dev/vg01/srv /srv &amp;&amp; df -h /srv</span>
</pre></div>

            </li>
</ol></div></div>
</div></div>
</div></div>
<div class="sect3 sect" id="lvm-resources"><div class="inner">
<div class="hgroup"><h3 class="title">Recursos</h3></div>
<div class="region"><div class="contents"><div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
              <p class="para">Veja os <a href="https://help.ubuntu.com/community/Installation#lvm" class="ulink" title="https://help.ubuntu.com/community/Installation#lvm">Artigos sobre LVM no Ubuntu Wiki</a>.</p>
            </li>
<li class="list itemizedlist">
              <p class="para">Veja o link  <a href="http://tldp.org/HOWTO/LVM-HOWTO/index.html" class="ulink" title="http://tldp.org/HOWTO/LVM-HOWTO/index.html">LVM HOWTO</a> para mais informações.</p>
            </li>
<li class="list itemizedlist">
              <p class="para">Outro bom artigo se enccontra em  <a href="http://www.linuxdevcenter.com/pub/a/linux/2006/04/27/managing-disk-space-with-lvm.html" class="ulink" title="http://www.linuxdevcenter.com/pub/a/linux/2006/04/27/managing-disk-space-with-lvm.html">Managing Disk Space with LVM</a> no site de O'Reilly linuxdevcenter.com</p>
            </li>
<li class="list itemizedlist">
              <p class="para">
              For more information on <span class="app application">fdisk</span> see the
              <a href="http://manpages.ubuntu.com/manpages/trusty/en/man8/fdisk.8.html" class="ulink" title="http://manpages.ubuntu.com/manpages/trusty/en/man8/fdisk.8.html">fdisk man page</a>.
              </p>
            </li>
</ul></div></div></div>
</div></div>
</div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="installing-upgrading.html" title="Atualizando">Anterior</a><a class="nextlinks-next" href="kernel-crash-dump.html" title="Kernel Crash Dump">Próximo</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p></div>
</div>
</body>
</html>
