<!DOCTYPE html>
<html lang=it>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Risoluzione problemi</title>
<link rel="stylesheet" type="text/css" href="it.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="http://www.ubuntu.com/partners">Partners</a></li>
<li><a href="http://www.ubuntu.com/support">Support</a></li>
<li><a href="http://www.ubuntu.com/community">Community</a></li>
<li><a href="http://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="http://community.ubuntu.com/contribute/documentation/">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../14.04" class="trail">Ubuntu 14.04</a> » <a class="trail" href="index.html" title="Guida a Ubuntu Server">Guida a Ubuntu Server</a> » <a class="trail" href="dns.html" title="DNS (Domain Name Service)">DNS (Domain Name Service)</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="dns-configuration.html" title="Configurazione">Indietro</a><a class="nextlinks-next" href="dns-references.html" title="Riferimenti">Avanti</a>
</div>
<div class="hgroup"><h1 class="title">Risoluzione problemi</h1></div>
<div class="region">
<div class="contents"><p class="para">Questa sezione descrive i metodi per determinare le cause dei problemi che si possono verificare con DNS e <span class="app application">BIND9</span>.</p></div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="dns-troubleshooting.html#dns-testing" title="Test">Test</a></li>
<li class="links"><a class="xref" href="dns-troubleshooting.html#dns-logging" title="Registrazione">Registrazione</a></li>
</ul></div>
<div class="sect2 sect" id="dns-testing"><div class="inner">
<div class="hgroup"><h2 class="title">Test</h2></div>
<div class="region">
<div class="contents"></div>
<div class="sect3 sect" id="dns-resolv.conf"><div class="inner">
<div class="hgroup"><h3 class="title">resolv.conf</h3></div>
<div class="region"><div class="contents">
<p class="para">Il primo passo per verificare <span class="app application">BIND9</span> consiste nell'aggiungere l'indirizzo IP del server di nomi in un risolutore host. Il server di nomi primario dovrebbe essere configurato così come un altro host per verificare il tutto. Fare riferimento a <a class="xref" href="network-configuration.html#dns-client-configuration" title="Configurazione del client DNS">Configurazione del client DNS</a> per dettagli sull'aggiunta di indirizzi di server di nomi e successivamente verificare che il file <span class="file filename">/etc/resolv.conf</span> contenga (per questo esempio)</p>
<div class="code"><pre class="contents ">nameserver	192.168.1.10
nameserver	192.168.1.11
</pre></div>
<p class="para">I server di nomi in ascolto su 127.* sono responsabili nell'aggiunta dei propri indirizzi IP in resolv.conf (usando reslconf). Ciò viene fatto per mezzo del file <span class="file filename">/etc/default/bind9</span> modificando la riga RESOLVCONF=no in RESOLVCONF=yes.</p>
<div class="note" title="Annotazione"><div class="inner"><div class="region"><div class="contents">
	      <p class="para">Potrebbe essere necessario aggiungere anche l'indirizzo IP del server di nomi secondario nel caso in cui il primario non fosse più disponibile.</p>
	    </div></div></div></div>
</div></div>
</div></div>
<div class="sect3 sect" id="dns-testing-dig"><div class="inner">
<div class="hgroup"><h3 class="title">dig</h3></div>
<div class="region"><div class="contents">
<p class="para">Se è stato installato il pacchetto <span class="app application">dnsutils</span>, è possibile configurare l'utilità di ricerca DNS <span class="app application">dig</span>:</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
	        <p class="para">Una volta installato <span class="app application">BIND9</span> usare <span class="app application">dig</span> sull'interfaccia di loopback per assicurarsi che sia in ascolto sulla porta 53. Da un terminale digitare:</p>
<div class="screen"><pre class="contents "><span class="cmd command">dig -x 127.0.0.1</span>
</pre></div>
	        <p class="para">L'output del comando dovrebbe essere simile al seguente:</p>
<div class="code"><pre class="contents ">;; Query time: 1 msec
;; SERVER: 192.168.1.10#53(192.168.1.10)
</pre></div>
	      </li>
<li class="list itemizedlist">
	        <p class="para">Se <span class="app application">BIND9</span> è stato configurato come un server di <span class="em emphasis">cache</span>, eseguire «dig» su un dominio esterno per verificare il tempo dell'interrogazione:</p>
<div class="screen"><pre class="contents "><span class="cmd command">dig ubuntu.com</span>
</pre></div>
	        <p class="para">Prestare attenzione al tempo dell'interrogazione verso la fine dell'output:</p>
<div class="code"><pre class="contents ">;; Query time: 49 msec
</pre></div>
	        <p class="para">Dopo una seconda esecuzione del comando si dovrebebro vedere dei miglioramenti:</p>
<div class="code"><pre class="contents ">;; Query time: 1 msec
</pre></div>
	      </li>
</ul></div>
</div></div>
</div></div>
<div class="sect3 sect" id="dns-testing-ping"><div class="inner">
<div class="hgroup"><h3 class="title">ping</h3></div>
<div class="region"><div class="contents">
<p class="para">Per dimostrare come le applicazioni utilizzino i DNS per interpretare un nome host, usare l'utilità <span class="app application">ping</span> per inviare una richiesta eco ICMP. Da un terminale digitare:</p>
<div class="screen"><pre class="contents "><span class="cmd command">ping example.com</span>
</pre></div>
<p class="para">In questo modo si verifica che il server dei nome sia in grado di interpretare il nome <span class="em emphasis">ns.example.com</span> in un indirizzo IP. L'output del comando dovrebbe essere simile a quanto segue:</p>
<div class="code"><pre class="contents ">PING ns.example.com (192.168.1.10) 56(84) bytes of data.
64 bytes from 192.168.1.10: icmp_seq=1 ttl=64 time=0.800 ms
64 bytes from 192.168.1.10: icmp_seq=2 ttl=64 time=0.813 ms
</pre></div>
</div></div>
</div></div>
<div class="sect3 sect" id="dns-testing-configuration"><div class="inner">
<div class="hgroup"><h3 class="title">named-checkzone</h3></div>
<div class="region"><div class="contents">
<p class="para">Un ottimo modo per provare i propri file zona consiste nell'usare l'utilità <span class="app application">named-checkzone</span> installata con il pacchetto <span class="app application">bind9</span>. Questa utilità consente di verificare che la configurazione sia corretta prima di riavviare <span class="app application">BIND9</span> e consentendo di apportare delle modifiche.</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
	        <p class="para">Per provare il file zona «Forward», in un terminale, digitare quanto segue:</p>
<div class="screen"><pre class="contents "><span class="cmd command">named-checkzone example.com /etc/bind/db.example.com</span>
</pre></div>
	        <p class="para">Se tutto è stato configurato correttamente, si dovrebbe vedere un output simile a questo:</p>
<div class="code"><pre class="contents ">zone example.com/IN: loaded serial 6
OK
</pre></div>
	      </li>
<li class="list itemizedlist">
	        <p class="para">Analogamente, per verificare il file zona «Reverse», digitare quanto segue:</p>
<div class="screen"><pre class="contents "><span class="cmd command">named-checkzone 1.168.192.in-addr.arpa /etc/bind/db.192</span>
</pre></div>
	        <p class="para">L'output dovrebbe essere simile a quanto segue:</p>
<div class="code"><pre class="contents ">zone 1.168.192.in-addr.arpa/IN: loaded serial 3
OK
</pre></div>
	      </li>
</ul></div>
<div class="note" title="Annotazione"><div class="inner"><div class="region"><div class="contents">
	     <p class="para">Il valore <span class="em emphasis">Serial</span> del proprio file zona probabilmente sarà diverso.</p>
	    </div></div></div></div>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="dns-logging"><div class="inner">
<div class="hgroup"><h2 class="title">Registrazione</h2></div>
<div class="region"><div class="contents">
<p class="para"><span class="app application">BIND9</span> dispone di diverse configurazione per la registrazione degli eventi. Le due opzioni principali sono: <span class="em emphasis">channel</span> che configura dove vengono salvate le registrazioni e l'opzione <span class="em emphasis">category</span> che determina quali informazioni registrare.</p>
<p class="para">Se non viene configurata alcuna opzione di registrazione, quella predefinita è:</p>
<div class="code"><pre class="contents ">logging {
     category default { default_syslog; default_debug; };
     category unmatched { null; };
};
</pre></div>
<p class="para">Questa sezione descrive come configurare <span class="app application">BIND9</span> affinché invii i messaggi di <span class="em emphasis">debug</span> relativi alle interrogazioni DNS in un file diverso.</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
	      <p class="para">Per prima cosa è necessario configurare un canale per specificare quale a quale file inviare i messaggi. Modificare quindi il file <span class="file filename">/etc/bind/named.conf.local</span> e aggiungere quanto segue:</p>
<div class="code"><pre class="contents ">logging {
    channel query.log {      
        file "/var/log/query.log";
        severity debug 3; 
    }; 
};
</pre></div>	    
	    </li>
<li class="list itemizedlist">
	      <p class="para">Configurare una categoria per inviare tutte le interrogazioni DNS al file:</p>
<div class="code"><pre class="contents ">logging {
    channel query.log {      
        file "/var/log/query.log"; 
        severity debug 3; 
    }; 
    <span class="em emphasis">category queries { query.log; };</span> 
};
</pre></div>	    
	    </li>
</ul></div>
<div class="note" title="Annotazione"><div class="inner"><div class="region"><div class="contents">
	    <p class="para">L'opzione <span class="em emphasis">debug</span> può essere impostata tra 1 e 3. Se non viene specificato alcun livello, viene considerato quello predefinito, cioè 1.</p>
	  </div></div></div></div>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
	      <p class="para">Dato che il demone <span class="em emphasis">named</span> viene eseguito come l'utente <span class="em emphasis">bind</span>, è necessario creare il file <span class="file filename">/var/log/query.log</span> e modificarne il proprietario:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo touch /var/log/query.log</span>
<span class="cmd command">sudo chown bind /var/log/query.log</span>
</pre></div>
	    </li>
<li class="list itemizedlist">
	      <p class="para">Prima che il demone <span class="app application">named</span> possa scrivere nel nuovo file di registrazione, il profilo <span class="app application">AppArmor</span> deve esser aggiorato. Per prima cosa modificare <span class="file filename">/etc/apparmor.d/usr.sbin.named</span> e aggiungere:</p>
<div class="code"><pre class="contents ">/var/log/query.log w,
</pre></div>
	      <p class="para">Quindi ricaricare il profilo:</p>
<div class="screen"><pre class="contents "><span class="cmd command">cat /etc/apparmor.d/usr.sbin.named | sudo apparmor_parser -r</span>
</pre></div>
	      <p class="para">Per maggiori informazioni riguardo <span class="app application">AppArmor</span>, consultare la <a class="xref" href="apparmor.html" title="AppArmor">AppArmor</a>.</p>
	    </li>
<li class="list itemizedlist">
	      <p class="para">Riavviare <span class="app application">BIND9</span> affinché le modifiche abbiano effetto:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo service bind9 restart</span>
</pre></div>
	    </li>
</ul></div>
<p class="para">Dovrebbe essere possibile vedere il file <span class="file filename">/var/log/query.log</span> riempirsi con le informazioni relative alle interrogazioni. Per maggio informazioni sulle opzioni di registrazione di <span class="app application">BIND9</span>, consultare la <a class="xref" href="dns-references.html#dns-more-info" title="Ulteriori informazioni">Ulteriori informazioni</a>.</p>
</div></div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="dns-configuration.html" title="Configurazione">Indietro</a><a class="nextlinks-next" href="dns-references.html" title="Riferimenti">Avanti</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p></div>
</div>
</body>
</html>
