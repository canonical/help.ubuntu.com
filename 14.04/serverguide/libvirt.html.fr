<!DOCTYPE html>
<html lang=fr>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>libvirt</title>
<link rel="stylesheet" type="text/css" href="fr.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="http://www.ubuntu.com/partners">Partners</a></li>
<li><a href="http://www.ubuntu.com/support">Support</a></li>
<li><a href="http://www.ubuntu.com/community">Community</a></li>
<li><a href="http://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="http://community.ubuntu.com/contribute/documentation/">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../14.04" class="trail">Ubuntu 14.04</a> » <a class="trail" href="index.html" title="Guide du serveur Ubuntu">Guide du serveur Ubuntu</a> » <a class="trail" href="virtualization.html" title="Virtualisation">Virtualisation</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="virtualization.html" title="Virtualisation">Précédent</a><a class="nextlinks-next" href="cloud-images-and-uvtool.html" title="Cloud images and uvtool">Suivant</a>
</div>
<div class="hgroup"><h1 class="title">libvirt</h1></div>
<div class="region">
<div class="contents">
<p class="para">La bibliothèque <span class="app application">libvirt</span> est utilisée pour s'interfacer avec différentes technologies de virtualisation. Avant de commencer avec <span class="app application">libvirt</span>, il est judicieux de s'assurer que votre matériel prend en charge les extensions de virtualisation pour <span class="app application">KVM</span>. Saisissez la commande suivante dans un terminal :</p>
<div class="screen"><pre class="contents "><span class="cmd command">kvm-ok</span>
</pre></div>
<p class="para">Un message vous informera si votre processeur <span class="em emphasis">prend en charge</span> ou <span class="em emphasis">non</span> la virtualisation matérielle.</p>
<div class="note" title="Note"><div class="inner"><div class="region"><div class="contents">
      <p class="para">Sur beaucoup d'ordinateurs équipés de microprocesseurs prenant en charge la virtualisation matérielle assistée, il est nécessaire d'activer une option dans le BIOS afin de pouvoir l'utiliser.</p>
    </div></div></div></div>
</div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="libvirt.html#virtual-networking" title="Virtualisation du réseau">Virtualisation du réseau</a></li>
<li class="links"><a class="xref" href="libvirt.html#libvirt-installation" title="Installation">Installation</a></li>
<li class="links"><a class="xref" href="libvirt.html#libvirt-virt-install" title="virt-install">virt-install</a></li>
<li class="links"><a class="xref" href="libvirt.html#libvirt-virt-clone" title="virt-clone">virt-clone</a></li>
<li class="links"><a class="xref" href="libvirt.html#libvirt-management" title="Gestion des machines virtuelles">Gestion des machines virtuelles</a></li>
<li class="links"><a class="xref" href="libvirt.html#libvirt-virt-viewer" title="Afficheur de machine virtuelle">Afficheur de machine virtuelle</a></li>
<li class="links"><a class="xref" href="libvirt.html#libvirt-resources" title="Ressources">Ressources</a></li>
</ul></div>
<div class="sect2 sect" id="virtual-networking"><div class="inner">
<div class="hgroup"><h2 class="title">Virtualisation du réseau</h2></div>
<div class="region"><div class="contents">
<p class="para">There are a few different ways to allow a virtual machine access
      to the external network. The default virtual network configuration
      includes <span class="em emphasis">bridging</span> and <span class="em emphasis">iptables</span>
      rules implementing <span class="em emphasis">usermode</span> networking, which uses
      the SLIRP protocol. Traffic is NATed through the host interface to the
      outside network.</p>
<p class="para">To enable external hosts to directly access services on virtual
      machines a different type of <span class="em emphasis">bridge</span> than the
      default needs to be configured. This allows the virtual interfaces to
      connect to the outside network through the physical interface, making
      them appear as normal hosts to the rest of the network.</p>
</div></div>
</div></div>
<div class="sect2 sect" id="libvirt-installation"><div class="inner">
<div class="hgroup"><h2 class="title">Installation</h2></div>
<div class="region"><div class="contents">
<p class="para">Pour installer les paquets nécessaires, saisissez dans un terminal :</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo apt-get install qemu-kvm libvirt-bin</span>
</pre></div>
<p class="para">Après l'installation de <span class="app application">libvirt-bin</span>, l'utilisateur qui doit gérer les machines virtuelles devra être ajouté au groupe <span class="em emphasis">libvirtd</span>. Ceci lui donnera les droits d'accès aux options avancés de configuration réseau.</p>
<p class="para">Dans un terminal saisissez :</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo adduser $USER libvirtd</span>
</pre></div>
<div class="note" title="Note"><div class="inner"><div class="region"><div class="contents">
        <p class="para">Si vous avez choisi l'utilisateur courant, vous devrez vous déconnecter, puis vous reconnecter pour que l'appartenance au nouveau groupe soit prise en compte.</p>
      </div></div></div></div>
<p class="para">Vous êtes maintenant prêt à installer un système d'exploitation <span class="em emphasis">Invité</span>. L'installation d'une machine virtuelle suit le même processus que l'installation d'un système d'exploitation directement sur le matériel. Vous avez besoin d'un moyen pour automatiser l'installation  ou bien un clavier ainsi qu'un moniteur devront être rattachés à la machine physique.</p>
<p class="para">Dans le cas des machines virtuelles une interface graphique (GUI) est analogue à l'utilisation d'un clavier physique et de la souris. Au lieu d'installer une interface graphique, <span class="app application">virt-viewer</span> peut être utilisé pour se connecter à la console d'une machine virtuelle grâce à <span class="app application">VNC</span>. Consultez <a class="xref" href="libvirt.html#libvirt-virt-viewer" title="Afficheur de machine virtuelle">Afficheur de machine virtuelle</a> pour plus d'informations.</p>
<p class="para">Il y a plusieurs façons d'automatiser le processus d'installation Ubuntu, par exemple en utilisant preseeds, Kickstart, etc. Reportez-vous au <a href="https:%20//help.ubuntu.com/14.04/installation-guide/" class="ulink" title="https: //help.ubuntu.com/14.04/installation-guide/">Guide d'Installation d'Ubuntu</a> en anglais pour plus de détails.</p>
<p class="para">Yet another way to install an Ubuntu virtual machine is to use
      <span class="app application">uvtool</span>.
      This application, available as of 14.04, allows you to set up
      specific VM options, execute custom post-install scripts, etc. For
      details see <a class="xref" href="cloud-images-and-uvtool.html" title="Cloud images and uvtool">Cloud images and uvtool</a>.</p>
<p class="para">Libvirt peut également être configuré avec <span class="app application">Xen</span>.  Pour plus de détails, voir la page de la communauté Xen Ubuntu référencée ci-dessous.</p>
</div></div>
</div></div>
<div class="sect2 sect" id="libvirt-virt-install"><div class="inner">
<div class="hgroup"><h2 class="title">virt-install</h2></div>
<div class="region"><div class="contents">
<p class="para"><span class="app application">virt-install</span> fait partie du paquet <span class="app application">virtinst</span>. Pour l'installer, saisissez dans un terminal :</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo apt-get install virtinst</span>
</pre></div>
<p class="para">Il y a plusieurs options disponibles pour utiliser <span class="app application">virt-install</span>. Par exemple :</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo virt-install -n web_devel -r 256 \ --disk path=/var/lib/libvirt/images/web_devel.img,bus=virtio,size=4 -c \ ubuntu-14.04-server-i386.iso --network network=default,model=virtio \ --graphics vnc,listen=0.0.0.0 --noautoconsole -v</span>
</pre></div>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">-n Web_devel :</span> le nom de la machine virtuelle sera <span class="em emphasis">Web_devel</span> dans cet exemple.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">-r 256:</span> spécifie la quantité de mémoire qu'utilisera la machine virtuelle en mégaoctets.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">--chemin du disque=/var/lib/libvirt/images/web_devel.img,size=4 :</span> montre le chemin d'accès au disque virtuel qui peut être un fichier, une partition ou un volume logique. Dans cet exemple, un fichier nommé <span class="file filename">web_devel.img</span> dans le répertoire /var/lib/libvirt/images/, avec une taille de 4 gigaoctets, et utilisant <span class="em emphasis">virtio</span> pour le bus disque.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">-c ubuntu-14.04-server-i386.iso:</span> file to be used as a virtual
          CDROM. The file can be either an ISO file or the path to the host's
          CDROM device.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">--network</span> fournit des détails liés à l'interface réseau de la machine virtuelle. Ici le réseau par <span class="em emphasis">défaut</span> est utilisé, et le modèle d'interface est configuré pour <span class="em emphasis">virtio</span>.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">--graphics vnc,listen=0.0.0.0 :</span> exporte la console virtuelle du client en utilisant VNC et sur toutes les interfaces hôte. Habituellement, les serveurs n'ont pas d'interface graphique, alors, un autre ordinateur muni d'une IG sur le réseau local (LAN) peut se connecter avec VNC pour terminer l'installation.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">--noautoconsole :</span> ne se connectera pas automatiquement à la console de la machine virtuelle.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">-v :</span> crée un invité totalement virtualisé.</p>
        </li>
</ul></div>
<p class="para">After launching <span class="app application">virt-install</span> you can
      connect to the virtual machine's console either locally using a GUI (if
      your server has a GUI), or via a remote VNC client from a GUI-based
      computer.</p>
</div></div>
</div></div>
<div class="sect2 sect" id="libvirt-virt-clone"><div class="inner">
<div class="hgroup"><h2 class="title">virt-clone</h2></div>
<div class="region"><div class="contents">
<p class="para">L'application <span class="app application">virt-clone</span>peut être utilisée pour copier une machine virtuelle vers une autre. Par exemple :</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo virt-clone -o web_devel -n database_devel -f /chemin/vers/database_devel.img \ --connect=qemu:///system</span> 
</pre></div>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">-o :</span> original virtual machine.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">-n :</span> nom de la nouvelle machine virtuelle.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">-f :</span> chemin du fichier, volume logique ou partition utilisé par la nouvelle machine virtuelle.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">--connect :</span> spécifie à quel hyperviseur se connecter.</p>
        </li>
</ul></div>
<p class="para">Vous pouvez également utiliser l'option <span class="em emphasis">-d</span> ou <span class="em emphasis">--debug</span> pour vous aider à résoudre les problèmes avec <span class="app application">virt-clone</span>.</p>
<div class="note" title="Note"><div class="inner"><div class="region"><div class="contents">
        <p class="para">Remplacez <span class="em emphasis">Web_devel</span> et <span class="em emphasis">database_devel</span> par les noms appropriés des machines virtuelles.</p>
      </div></div></div></div>
</div></div>
</div></div>
<div class="sect2 sect" id="libvirt-management"><div class="inner">
<div class="hgroup"><h2 class="title">Gestion des machines virtuelles</h2></div>
<div class="region">
<div class="contents"></div>
<div class="sect3 sect" id="virsh"><div class="inner">
<div class="hgroup"><h3 class="title">virsh</h3></div>
<div class="region"><div class="contents">
<p class="para">Il existe plusieurs utilitaires disponibles pour gérer les machines virtuelles et <span class="app application">libvirt</span>. L'application <span class="app application">virsh</span> s'utilise en ligne de commande. Quelques exemples :</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
            <p class="para">Pour lister les machines virtuelles en cours d'exécution :</p>

            <div class="screen"><pre class="contents "><span class="cmd command">virsh -c qemu:///system list</span>
</pre></div>
          </li>
<li class="list itemizedlist">
            <p class="para">Pour démarrer une machine virtuelle :</p>

            <div class="screen"><pre class="contents "><span class="cmd command">virsh -c qemu:///system start web_devel</span>
</pre></div>
          </li>
<li class="list itemizedlist">
            <p class="para">De la même façon, pour lancer une machine virtuelle au démarrage :</p>

            <div class="screen"><pre class="contents "><span class="cmd command">virsh -c qemu:///system autostart web_devel</span>
</pre></div>
          </li>
<li class="list itemizedlist">
            <p class="para">Redémarrez une machine virtuelle avec :</p>

            <div class="screen"><pre class="contents "><span class="cmd command">virsh -c qemu:///system reboot web_devel</span>
</pre></div>
          </li>
<li class="list itemizedlist">
            <p class="para">L'<span class="em emphasis">état</span> des machine virtuelles peut être enregistré dans un fichier pour pouvoir être restauré plus tard. Ce qui suit enregistrera l'état d'une machine virtuelle dans un fichier nommé d'après la date :</p>

            <div class="screen"><pre class="contents "><span class="cmd command">virsh -c qemu:///system save web_devel web_devel-022708.state</span>
</pre></div>

            <p class="para">Une fois son état enregistré, une machine virtuelle ne sera plus en cours d'exécution.</p>
          </li>
<li class="list itemizedlist">
            <p class="para">Une machine virtuelle dont l'état est enregistré peut être restaurée en utilisant :</p>

            <div class="screen"><pre class="contents "><span class="cmd command">virsh -c qemu:///system restore web_devel-022708.state</span>
</pre></div>
          </li>
<li class="list itemizedlist">
            <p class="para">Pour arrêter une machine virtuelle :</p>

            <div class="screen"><pre class="contents "><span class="cmd command">virsh -c qemu:///system shutdown web_devel</span>
</pre></div>
          </li>
<li class="list itemizedlist">
            <p class="para">Un CDROM peut être monté dans une machine virtuelle en saisissant :</p>

            <div class="screen"><pre class="contents "><span class="cmd command">virsh -c qemu:///system attach-disk web_devel /dev/cdrom /media/cdrom</span>
</pre></div>
          </li>
</ul></div>
<div class="note" title="Note"><div class="inner"><div class="region"><div class="contents">
          <p class="para">Dans les exemples ci-dessus, remplacez <span class="em emphasis">Web_devel</span> par le nom approprié pour la machine virtuelle, et <span class="file filename">Web_devel-022708.state</span> par un nom de fichier explicite.</p>
        </div></div></div></div>
</div></div>
</div></div>
<div class="sect3 sect" id="virt-manager"><div class="inner">
<div class="hgroup"><h3 class="title">Gestionnaire de machine virtuelle</h3></div>
<div class="region"><div class="contents">
<p class="para">Le paquet <span class="app application">virt-manager</span> contient un outil en mode graphique pour gérer les machines virtuelles locales et distantes. Pour installer virt-manager saisissez :</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo apt-get install virt-manager</span>
</pre></div>
<p class="para">Étant donné que <span class="app application">virt-manager</span> exige un environnement contenant une interface graphique (GUI), il est recommandé de l’installer sur un poste de travail ou une machine de test mais pas sur un serveur de production. Pour vous connecter au service local<span class="app application">libvirt</span> tapez :</p>
<div class="screen"><pre class="contents "><span class="cmd command">virt-manager -c qemu:///system</span>
</pre></div>
<p class="para">Vous pouvez vous connecter au service <span class="app application">libvirt</span> s'exécutant sur un autre hôte en saisissant ce qui suit dans un terminal :</p>
<div class="screen"><pre class="contents "><span class="cmd command">virt-manager -c qemu+ssh://virtnode1.mydomain.com/system</span>
</pre></div>
<div class="note" title="Note"><div class="inner"><div class="region"><div class="contents">
          <p class="para">L'exemple ci-dessus suppose que la connectivité <span class="app application">SSH</span> entre le système de gestion et virtnode1.mydomain.com a déjà été configurée, et utilise les clés SSH pour l'authentification. <span class="em emphasis">Les clés</span> SSH sont nécessaires car <span class="app application">libvirt</span> envoie le mot de passe à un autre processus. Pour plus de renseignements sur la configuration de <span class="app application">SSH</span>, consultez <a class="xref" href="openssh-server.html" title="Serveur OpenSSH">Serveur OpenSSH</a>.</p>
        </div></div></div></div>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="libvirt-virt-viewer"><div class="inner">
<div class="hgroup"><h2 class="title">Afficheur de machine virtuelle</h2></div>
<div class="region"><div class="contents">
<p class="para">L'application <span class="app application">virt-viewer</span> vous permet de vous connecter à une console de la machine virtuelle. <span class="app application">virt-viewer</span> nécessite une interface graphique utilisateur (GUI) pour interagir avec la machine virtuelle.</p>
<p class="para">Pour installer <span class="app application">virt-viewer</span>, depuis un terminal saisissez :</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo apt-get install virt-viewer</span>
</pre></div>
<p class="para">Une fois qu'une machine virtuelle est installée et est en exécution vous pouvez vous connectez à la console de la machine virtuelle en utilisant :</p>
<div class="screen"><pre class="contents "><span class="cmd command">virt-viewer -c qemu:///system web_devel</span>
</pre></div>
<p class="para">De même que <span class="app application">virt-manager</span>, <span class="app application">virt-viewer</span> peut se connecter à un hôte distant en utilisant <span class="em emphasis">SSH</span> avec authentification par clé, comme ceci :</p>
<div class="screen"><pre class="contents "><span class="cmd command">virt-viewer -c qemu+ssh://virtnode1.mydomain.com/system web_devel</span>
</pre></div>
<p class="para">Assurez-vous de remplacer <span class="em emphasis">web_devel</span> par le nom de la machine virtuelle approprié.</p>
<p class="para">If configured to use a <span class="em emphasis">bridged</span> network
      interface you can also setup <span class="app application">SSH</span> access to
      the virtual machine.</p>
</div></div>
</div></div>
<div class="sect2 sect" id="libvirt-resources"><div class="inner">
<div class="hgroup"><h2 class="title">Ressources</h2></div>
<div class="region"><div class="contents"><div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
          <p class="para">Voir la page d'accueil de <a href="http://www.linux-kvm.org/" class="ulink" title="http://www.linux-kvm.org/">KVM</a> pour plus de détails.</p>
        </li>
<li class="list itemizedlist">
          <p class="para">Pour plus d'informations sur <span class="app application">libvirt</span>, consultez la <a href="http://libvirt.org/" class="ulink" title="http://libvirt.org/">page d'accueil de libvirt</a></p>
        </li>
<li class="list itemizedlist">
          <p class="para">The <a href="http://virt-manager.org/" class="ulink" title="http://virt-manager.org/">Virtual
          Machine Manager</a> site has more information on
          <span class="app application">virt-manager</span> development.</p>
        </li>
<li class="list itemizedlist">
          <p class="para">Vous pouvez aussi passer par le canal IRC <span class="em emphasis">#ubuntu-virt</span> sur <a href="http://freenode.net/" class="ulink" title="http://freenode.net/">freenode</a> pour discuter (en anglais) de la technologie de virtualisation sous Ubuntu.</p>
        </li>
<li class="list itemizedlist">
          <p class="para">Une autre source d'information est la page du <a href="https://help.ubuntu.com/community/KVM" class="ulink" title="https://help.ubuntu.com/community/KVM">Wiki Ubuntu consacrée à KVM</a>.</p>
        </li>
<li class="list itemizedlist">
          <p class="para">Pour plus d'informations sur Xen, y compris l'utilisation Xen avec libvirt, veuillez voir la page du <a href="https://help.ubuntu.com/community/Xen" class="ulink" title="https://help.ubuntu.com/community/Xen">Wiki Ubuntu sur Xen</a>.</p>
        </li>
</ul></div></div></div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="virtualization.html" title="Virtualisation">Précédent</a><a class="nextlinks-next" href="cloud-images-and-uvtool.html" title="Cloud images and uvtool">Suivant</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p></div>
</div>
</body>
</html>
