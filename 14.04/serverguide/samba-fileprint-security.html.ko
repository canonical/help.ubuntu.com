<!DOCTYPE html>
<html lang=ko>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Securing File and Print Server</title>
<link rel="stylesheet" type="text/css" href="ko.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="http://www.ubuntu.com/partners">Partners</a></li>
<li><a href="http://www.ubuntu.com/support">Support</a></li>
<li><a href="http://www.ubuntu.com/community">Community</a></li>
<li><a href="http://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="http://community.ubuntu.com/contribute/documentation/">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../14.04" class="trail">Ubuntu 14.04</a> » <a class="trail" href="index.html" title="우분투 서버 가이드">우분투 서버 가이드</a> » <a class="trail" href="samba.html" title="Samba">Samba</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="samba-printserver.html" title="인쇄 서버">이전</a><a class="nextlinks-next" href="samba-dc.html" title="As a Domain Controller">다음</a>
</div>
<div class="hgroup"><h1 class="title">Securing File and Print Server</h1></div>
<div class="region">
<div class="contents"></div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="samba-fileprint-security.html#samba-security-mode" title="삼바 보안 모드들">삼바 보안 모드들</a></li>
<li class="links"><a class="xref" href="samba-fileprint-security.html#samba-user-security" title="Security = User">Security = User</a></li>
<li class="links"><a class="xref" href="samba-fileprint-security.html#samba-share-security" title="공유 보안">공유 보안</a></li>
<li class="links"><a class="xref" href="samba-fileprint-security.html#samba-apparmor" title="삼바 AppArmor 프로파일">삼바 AppArmor 프로파일</a></li>
<li class="links"><a class="xref" href="samba-fileprint-security.html#samba-security-resources" title="자원들">자원들</a></li>
</ul></div>
<div class="sect2 sect" id="samba-security-mode"><div class="inner">
<div class="hgroup"><h2 class="title">삼바 보안 모드들</h2></div>
<div class="region"><div class="contents">
<p class="para">공통 인터넷 파일 시스템 (Common Internet Filesystem, CIFS) 네트워크 규약으로 쓸 수 있는 보안 수준은 <span class="em emphasis">사용자 수준</span>과 <span class="em emphasis">공유 수준</span> 두 가지가 있습니다.  삼바의 <span class="em emphasis">보안 모드</span> 구현은 더 유연하며, 네 가지 사용자 수준 보안 구현과 한 가자 공유 수준 구현이 제공됩니다.</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">security = user:</span>은 공유에 연결할 때 제공된 사용자 이름과 암호를 클라이언트에 요구합니다.  삼바 사용자 계정은 시스템 계정과 분리되어 있으나, <span class="app application">libpam-smbpass</span> 패키지는 시스템 사용자와 암호를 삼바 사용자 데이터베이스와 연동시킵니다.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">security = domain:</span> 이 모드는 삼바 서버가 윈도즈 클라이언트에 기본 도메인 제어기(Primary Domain Controller, PDC), 또는 백업 도메인 제어기(Backup Domain Controller, BDC), 도메인 구성원 버서(Domain Member Server, DMS)로 보이도록 합니다.  추가 정보는 <a class="xref" href="samba-dc.html" title="As a Domain Controller">As a Domain Controller</a>를 보세요.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">security = ADS:</span>는 삼바 서버가 액티브 디렉터리 도메인에 네이티브 구성원으로 합류하도록 합니다.  <a class="xref" href="samba-ad-integration.html" title="Active Directory Integration">Active Directory Integration</a>를 보세요.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">security = server:</span> 이 모드는 삼바가 구성원 서버가 될 수 있도록 하기 위해 남겨놓은 것이지만 몇 가지 보안 문제로 인해 사용하면 안 됩니다.  더 자세한 것들은 삼바 가이드의 <a href="http://samba.org/samba/docs/man/Samba-HOWTO-Collection/ServerType.html#id349531" class="ulink" title="http://samba.org/samba/docs/man/Samba-HOWTO-Collection/ServerType.html#id349531">서버 보안</a>을 보세요.</p>
        </li>
<li class="list itemizedlist">
          <p class="para"><span class="em emphasis">security = share:</span>는 클라이언트가 제공된 사용자 이름과 암호 없이 공유에 연결하게 합니다.</p>
        </li>
</ul></div>
<p class="para">선택할 보안 모드는 환경과 삼바 서버로 무엇을 할 것인가에 따라 결정합니다.</p>
</div></div>
</div></div>
<div class="sect2 sect" id="samba-user-security"><div class="inner">
<div class="hgroup"><h2 class="title">Security = User</h2></div>
<div class="region"><div class="contents">
<p class="para">이 절에서는 <a class="xref" href="samba-fileserver.html" title="File Server">File Server</a>와 <a class="xref" href="samba-printserver.html" title="인쇄 서버">인쇄 서버</a>에서 인증을 요구하도록 삼바 파일, 프린터 서버를 재구성할 것입니다.</p>
<p class="para">첫번째로, 시스템 사용자와 삼바 사용자 데이터베이스를 동기화시킬 <span class="app application">libpam-smbpass</span> 패키지를 설치:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo apt-get install libpam-smbpass</span>
</pre></div>
<div class="note" title="알림"><div class="inner"><div class="region"><div class="contents">
        <p class="para">설치하는 동안 <span class="em emphasis">Samba Server</span> 태스크를 선택했다면, <span class="app application">libpam-smbpass</span>는 이미 설치되어 있습니다.</p>
      </div></div></div></div>
<p class="para"><span class="file filename">/etc/samba/smb.conf</span>를 편집, 안에 있는 <span class="em emphasis">[share]</span> 절을 수정:</p>
<div class="code"><pre class="contents ">    guest ok = no
</pre></div>
<p class="para">마지막으로, 새로운 설정이 적용되도록 삼바를 다시 시작:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo restart smbd</span>
<span class="cmd command">sudo restart nmbd</span>
</pre></div>
<p class="para">이제 공유된 디렉터리나 프린터에 연결할 때 사용자 이름과 암호를 묻게 됩니다.</p>
<div class="note" title="알림"><div class="inner"><div class="region"><div class="contents">
        <p class="para">네트워크 드라이브를 설정하려고 하면 <span class="quote">“로그온 시 다시 연결”</span> 확인 상자를 체크할 수 있으며, 사용자 이름과 암호를 한 번 만 입력하면 암호를 변경하기 전까지 다시 물어보지 않습니다.</p>
      </div></div></div></div>
</div></div>
</div></div>
<div class="sect2 sect" id="samba-share-security"><div class="inner">
<div class="hgroup"><h2 class="title">공유 보안</h2></div>
<div class="region">
<div class="contents"><p class="para">각각의 공유 디렉터리의 보안성을 높이기 위해 쓸 수 있는 몇 가지 옵션들이 있습니다.  이 절은 <span class="em emphasis">[share]</span> 예제를 사용해서, 몇 개의 일반적인 옵션을 다룰 것입니다.</p></div>
<div class="sect3 sect" id="windows-networking-groups"><div class="inner">
<div class="hgroup"><h3 class="title">그룹</h3></div>
<div class="region"><div class="contents">
<p class="para">그룹은 특정 네트워크 자원을 접근하는 공통적인 등급을 가지는 컴퓨터 또는 사용자의 집합을 지정하고 그러한 네트워크 자원으로 접근하는 것을 관리하는 선별 정도의 등급을 제공 합니다. 예를 들어, 그룹 <span class="em emphasis">qa</span> 가 지정되었고 사용자 <span class="em emphasis">freda</span>, <span class="em emphasis">danika</span>, 그리고 <span class="em emphasis">rob</span> 을 포함하고 있고, 두 번째 그룹 <span class="em emphasis">support</span> 가 지정되었고 사용자 <span class="em emphasis">danika</span>, <span class="em emphasis">jeremy</span>, 그리고 <span class="em emphasis">vincent</span> 로 구성된다면, 특정 네트워크 자원은 <span class="em emphasis">qa</span> 그룹에 의해 접근되는 것을 허용하기 위하여 설정될 수 있고 그 결과로 freda, danika, rob은 접근이 허용되지만 jeremy 또는 vincent는 접근을 할 수 없게 됩니다. 사용자 <span class="em emphasis">danika</span> 는 <span class="em emphasis">qa</span> 와 <span class="em emphasis">support</span> 그룹 양쪽 모두에 속하므로, 그녀는 양쪽 그룹에 의한 접근을 위하여 설정되는 자원을 사용할 수 있게되고, 모든 다른 사용자들은 그들이 속하는 그룹에게 명시적으로 허용한 자원만을 사용하게 됩니다.</p>
<p class="para">사용자가 어떤 그룹에 속하는 지를 결정하기 위해 기본적으로 삼바는 <span class="file filename">/etc/group</span>에 정의된 지역 시스템 그룹을 찾습니다.  그룹에 사용자를 추가하고 제거하는 것에 대한 더 많은 정보는 <a class="xref" href="user-management.html#adding-deleting-users" title="Adding and Deleting Users">Adding and Deleting Users</a>를 보세요.</p>
<p class="para">삼바 구성 파일, <span class="file filename">/etc/samba/smb.conf</span>에 그룹을 정의할 때, 그룹 이름 앞에 "@" 기호를 붙여야지 그룹으로 인식됩니다.  예를 들어, <span class="file filename">/etc/samba/smb.conf</span>의 어떤 절에 <span class="em emphasis">sysadmin</span> 그룹 이름을 정의하려면, <span class="em em-bold emphasis">@sysadmin</span>로 그룹 이름을 입력해야 합니다.</p>
</div></div>
</div></div>
<div class="sect3 sect" id="samba-file-permissions"><div class="inner">
<div class="hgroup"><h3 class="title">파일 권한</h3></div>
<div class="region"><div class="contents">
<p class="para">
        File Permissions define the explicit rights a computer or user has to a particular directory, file, or set of
        files.  Such permissions may be defined by editing the <span class="file filename">/etc/samba/smb.conf</span> file and specifying
        the explicit permissions of a defined file share.
        </p>
<p class="para">
        For example, if you have defined a Samba share called <span class="em emphasis">share</span> and wish to give 
        <span class="em emphasis">read-only</span> permissions to the group of users known as 
        <span class="em emphasis">qa</span>, but wanted to allow writing to the share by the group called 
        <span class="em emphasis">sysadmin</span> and the user named <span class="em emphasis">vincent</span>, 
        then you could edit the <span class="file filename">/etc/samba/smb.conf</span> file, and add the following entries under 
        the <span class="em emphasis">[share]</span> entry:
        </p>
<div class="code"><pre class="contents ">    read list = @qa
    write list = @sysadmin, vincent
</pre></div>
<p class="para">
        Another possible Samba permission is to declare <span class="em emphasis">administrative</span> permissions to a
        particular shared resource.  Users having administrative permissions may read, write, or modify any information
        contained in the resource the user has been given explicit administrative permissions to.
        </p>
<p class="para">
        For example, if you wanted to give the user <span class="em emphasis">melissa</span> administrative permissions to
        the <span class="em emphasis">share</span> example, you would edit the 
        <span class="file filename">/etc/samba/smb.conf</span> file, and add the following line under the 
        <span class="em emphasis">[share]</span> entry:
        </p>
<div class="code"><pre class="contents ">    admin users = melissa
</pre></div>
<p class="para">
        After editing <span class="file filename">/etc/samba/smb.conf</span>, restart Samba for the changes to take effect:
        </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo restart smbd</span>
<span class="cmd command">sudo restart nmbd</span>
</pre></div>
<div class="note" title="알림"><div class="inner"><div class="region"><div class="contents">
          <p class="para">
          For the <span class="em emphasis">read list</span> and <span class="em emphasis">write list</span> to work the Samba security mode
          must <span class="em emphasis">not</span> be set to <span class="em emphasis">security = share</span>
          </p>
        </div></div></div></div>
<p class="para">
        Now that Samba has been configured to limit which groups have access to the shared directory, the filesystem permissions
        need to be updated.
        </p>
<p class="para">
        Traditional Linux file permissions do not map well to Windows NT Access Control Lists (ACLs).  Fortunately POSIX ACLs
        are available on Ubuntu servers providing more fine grained control.  For example, to enable ACLs on  
        <span class="file filename">/srv</span> an EXT3 filesystem, edit <span class="file filename">/etc/fstab</span> adding the 
        <span class="em emphasis">acl</span> option:
        </p>
<div class="code"><pre class="contents ">UUID=66bcdd2e-8861-4fb0-b7e4-e61c569fe17d /srv  ext3    noatime,relatime,acl 0       1
</pre></div>
<p class="para">그런 다음 파티션을 다시 마운트시킴:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo mount -v -o remount /srv</span>
</pre></div>
<div class="note" title="알림"><div class="inner"><div class="region"><div class="contents">
          <p class="para">
          The above example assumes <span class="file filename">/srv</span> on a separate partition.  If <span class="file filename">/srv</span>,
          or wherever you have configured your share path, is part of the <span class="file filename">/</span> partition a reboot may be 
          required.
          </p>
        </div></div></div></div>
<p class="para">
        To match the Samba configuration above the <span class="em emphasis">sysadmin</span> group will be given read, write, and execute
        permissions to <span class="file filename">/srv/samba/share</span>, the <span class="em emphasis">qa</span> group will be given read and execute
        permissions, and the files will be owned by the username <span class="em emphasis">melissa</span>.  Enter the following in a 
        terminal:
        </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo chown -R melissa /srv/samba/share/</span>
<span class="cmd command">sudo chgrp -R sysadmin /srv/samba/share/</span>
<span class="cmd command">sudo setfacl -R -m g:qa:rx /srv/samba/share/</span>
</pre></div>
<div class="note" title="알림"><div class="inner"><div class="region"><div class="contents">
          <p class="para">
          The <span class="app application">setfacl</span> command above gives <span class="em emphasis">execute</span> permissions to all files in
          the <span class="file filename">/srv/samba/share</span> directory, which you may or may not want.
          </p>
        </div></div></div></div>
<p class="para">
        Now from a Windows client you should notice the new file permissions are implemented.  See the 
        <span class="app application">acl</span> and <span class="app application">setfacl</span> man pages for more information on POSIX ACLs.
        </p>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="samba-apparmor"><div class="inner">
<div class="hgroup"><h2 class="title">삼바 AppArmor 프로파일</h2></div>
<div class="region"><div class="contents">
<p class="para">
      Ubuntu comes with the <span class="app application">AppArmor</span> security module, which provides mandatory access controls.
      The default AppArmor profile for Samba will need to be adapted to your configuration.  For more details on using
      AppArmor see <a class="xref" href="apparmor.html" title="AppArmor">AppArmor</a>.
      </p>
<p class="para">
      There are default AppArmor profiles for <span class="file filename">/usr/sbin/smbd</span> and <span class="file filename">/usr/sbin/nmbd</span>, the
      Samba daemon binaries, as part of the <span class="app application">apparmor-profiles</span> packages.  To install the package,
      from a terminal prompt enter:
      </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo apt-get install apparmor-profiles apparmor-utils</span>
</pre></div>
<div class="note" title="알림"><div class="inner"><div class="region"><div class="contents">
        <p class="para">이 패키지에는 몇 가지 다른 바이너리들에 대한 프로파일들이 있습니다.</p>
      </div></div></div></div>
<p class="para">
      By default the profiles for <span class="app application">smbd</span> and <span class="app application">nmbd</span> are in 
      <span class="em emphasis">complain</span> mode allowing Samba to work without modifying the profile, and only logging errors.
      To place the <span class="app application">smbd</span> profile into <span class="em emphasis">enforce</span> mode, and have Samba work as 
      expected, the profile will need to be modified to reflect any directories that are shared.
      </p>
<p class="para">
      Edit <span class="file filename">/etc/apparmor.d/usr.sbin.smbd</span> adding information for <span class="em emphasis">[share]</span> from the
      file server example:
      </p>
<div class="code"><pre class="contents ">  /srv/samba/share/ r,
  /srv/samba/share/** rwkix,
</pre></div>
<p class="para">
      Now place the profile into <span class="em emphasis">enforce</span> and reload it:
      </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo aa-enforce /usr/sbin/smbd</span>
<span class="cmd command">cat /etc/apparmor.d/usr.sbin.smbd | sudo apparmor_parser -r</span>
</pre></div>
<p class="para">
      You should now be able to read, write, and execute files in the shared directory as normal, and the
      <span class="app application">smbd</span> binary will have access to only the configured files and directories.  
      Be sure to add entries for each directory you configure Samba to share.  Also, any errors will be logged
      to <span class="file filename">/var/log/syslog</span>.  
      </p>
</div></div>
</div></div>
<div class="sect2 sect" id="samba-security-resources"><div class="inner">
<div class="hgroup"><h2 class="title">자원들</h2></div>
<div class="region"><div class="contents"><div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
          <p class="para">심도 있는 삼바 구성에 대한 것은 <a href="http://samba.org/samba/docs/man/Samba-HOWTO-Collection/" class="ulink" title="http://samba.org/samba/docs/man/Samba-HOWTO-Collection/">삼바 사용법 모음</a>을 보세요.</p>
        </li>
<li class="list itemizedlist">
          <p class="para">이 가이드는 <a href="http://www.amazon.com/exec/obidos/tg/detail/-/0131882228" class="ulink" title="http://www.amazon.com/exec/obidos/tg/detail/-/0131882228">인쇄된 포맷</a>으로도 볼 수 있습니다.</p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          O'Reilly's <a href="http://www.oreilly.com/catalog/9780596007690/" class="ulink" title="http://www.oreilly.com/catalog/9780596007690/">Using Samba</a> is also a good
          reference.
          </p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          <a href="http://samba.org/samba/docs/man/Samba-HOWTO-Collection/securing-samba.html" class="ulink" title="http://samba.org/samba/docs/man/Samba-HOWTO-Collection/securing-samba.html">Chapter 18</a> 
          of the Samba HOWTO Collection is devoted to security.
          </p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          For more information on Samba and ACLs see the
          <a href="http://samba.org/samba/docs/man/Samba-HOWTO-Collection/AccessControls.html#id397568" class="ulink" title="http://samba.org/samba/docs/man/Samba-HOWTO-Collection/AccessControls.html#id397568">Samba ACLs page
          </a>.
          </p>
        </li>
<li class="list itemizedlist">
          <p class="para">
          The <a href="https://help.ubuntu.com/community/Samba" class="ulink" title="https://help.ubuntu.com/community/Samba">Ubuntu Wiki Samba </a> page.
          </p>
        </li>
</ul></div></div></div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="samba-printserver.html" title="인쇄 서버">이전</a><a class="nextlinks-next" href="samba-dc.html" title="As a Domain Controller">다음</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p></div>
</div>
</body>
</html>
