<!DOCTYPE html>
<html lang=zh-CN>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Subversion</title>
<link rel="stylesheet" type="text/css" href="zh_CN.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="http://www.ubuntu.com/partners">Partners</a></li>
<li><a href="http://www.ubuntu.com/support">Support</a></li>
<li><a href="http://www.ubuntu.com/community">Community</a></li>
<li><a href="http://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="http://community.ubuntu.com/contribute/documentation/">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../14.04" class="trail">Ubuntu 14.04</a> » <a class="trail" href="index.html" title="Ubuntu 服务器指南">Ubuntu 服务器指南</a> » <a class="trail" href="version-control-system.html" title="版本控制系统">版本控制系统</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="git.html" title="Git">上一页</a><a class="nextlinks-next" href="version-control-ref.html" title="参考资料">下一页</a>
</div>
<div class="hgroup"><h1 class="title">Subversion</h1></div>
<div class="region">
<div class="contents"><p class="para">Subversion 是一个开源的版本控制系统。使用 Subversion，您可以记录源文件和文档的历史。它管理文件和目录。文件树被放入了中心库中。库更象是一个普通的文件服务器，除了它可以记住对文件和目录的每次改变。</p></div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="subversion.html#subversion-installation" title="安装">安装</a></li>
<li class="links"><a class="xref" href="subversion.html#subversion-configuration" title="服务器配置">服务器配置</a></li>
<li class="links"><a class="xref" href="subversion.html#access-methods" title="访问方式">访问方式</a></li>
</ul></div>
<div class="sect2 sect" id="subversion-installation"><div class="inner">
<div class="hgroup"><h2 class="title">安装</h2></div>
<div class="region"><div class="contents">
<p class="para">要通过 HTTP 协议来访问 Subversion 库，您必须安装和配置一个 web 服务器。Apache2 被证明可以和 Subversion 一起工作。请参考 Apache2 章节的 HTTP 小节以安装和配置 Apache2。要使用 HTTPS 协议访问 Subversion 库，您必须在您的 Apache2 web 服务器上安装和配置数字证书。请参考  Apache2 章节的 HTTPS 小节以安装和配置数据证书。</p>
<p class="para">要安装 Subversion，可以在终端提示符后运行以下命令：</p>
<p class="para">
<div class="screen"><pre class="contents "><span class="cmd command">sudo apt-get install subversion apache2 libapache2-svn</span>
</pre></div>
	    </p>
</div></div>
</div></div>
<div class="sect2 sect" id="subversion-configuration"><div class="inner">
<div class="hgroup"><h2 class="title">服务器配置</h2></div>
<div class="region">
<div class="contents"><p class="para">这一步假定您已经在您的系统上安装了上面提及的包。本部分内容说明如何创建一个 Subversion 库和访问项目。</p></div>
<div class="sect3 sect" id="create-svn-repos"><div class="inner">
<div class="hgroup"><h3 class="title">创建 Subversion 库</h3></div>
<div class="region"><div class="contents">
<p class="para">Subversion 库可以在终端提示符后使用以下命令创建：</p>
<p class="para">
<div class="screen"><pre class="contents "><span class="cmd command">svnadmin create /path/to/repos/project</span>
</pre></div>
        </p>
</div></div>
</div></div>
<div class="sect3 sect" id="import-svn-files"><div class="inner">
<div class="hgroup"><h3 class="title">导入文件</h3></div>
<div class="region"><div class="contents"><p class="para">创建库后,你可以将文件<span class="em emphasis">导入</span>到库中. 要导入文件夹, 在终端命令行中输入下面命令
<span class="cmd command">svn import /path/to/import/directory file:///path/to/repos/project</span>
</p></div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="access-methods"><div class="inner">
<div class="hgroup"><h2 class="title">访问方式</h2></div>
<div class="region">
<div class="contents">
<p class="para">版本库可以通过很多方式来存取（签出）--在本地磁盘，或者通过各种各样的网络协议。然而一个库的位置始终是个URL。表里描述了不同存取方法下的不同URL样子。</p>
<div class="table">
<div class="title"><h3><span class="title">访问方式</span></h3></div>
<table summary="访问方式" style="border: solid 1px;">
<thead><tr>
<th class="td-colsep"><p class="para">模式</p></th>
<th><p class="para">访问方式</p></th>
</tr></thead>
<tbody>
<tr>
<td class="td-colsep"><p class="para">file://</p></td>
<td><p class="para">直接访问库 (在本地磁盘)</p></td>
</tr>
<tr class="shade">
<td class="td-colsep"><p class="para">http://</p></td>
<td><p class="para">通过 WebDAV 协议访问带有 Subversion 的 Apache2 web 服务器。</p></td>
</tr>
<tr>
<td class="td-colsep"><p class="para">https://</p></td>
<td><p class="para">与 http:// 相同，但有 SSL 加密</p></td>
</tr>
<tr class="shade">
<td class="td-colsep"><p class="para">svn://</p></td>
<td><p class="para">通过自身协议访问 svnserve 服务</p></td>
</tr>
<tr>
<td class="td-colsep"><p class="para">svn+ssh://</p></td>
<td><p class="para">与 svn:// 一样，但使用 SSH 遂道</p></td>
</tr>
</tbody>
</table>
</div>
<p class="para">在本部分，我们将看到如何为所有这些访问方式来配置 Subversion。这里，我们只介绍基本用法。更多详细、高级用法请参阅<a href="http://svnbook.red-bean.com/" class="ulink" title="http://svnbook.red-bean.com/">svn 书</a></p>
</div>
<div class="sect3 sect" id="direct-repos-access"><div class="inner">
<div class="hgroup"><h3 class="title">直接访问库 (file://)</h3></div>
<div class="region"><div class="contents">
<p class="para">这是所有访问方式中最简单的。它不要求运行任何 Subversion 服务器进程。该访问方式用于在同一台机器上访问 Subversion。在终端提示符后输入的命令如下所示：</p>
<p class="para">
<div class="screen"><pre class="contents "><span class="cmd command">svn co file:///path/to/repos/project</span>
</pre></div>
        </p>
<p class="para">或</p>
<p class="para">
<div class="screen"><pre class="contents "><span class="cmd command">svn co file://localhost/path/to/repos/project</span>
</pre></div>
        </p>
<div class="note" title="备注"><div class="inner"><div class="region"><div class="contents">
		<p class="para">如果您没有指定主机名，则需要三个斜杠 (///) -- 其中两个是协议的 (这里是 file)，另一个是路径前的。如果您指定了主机名，那么您必须使用双个斜杠 (//)。</p>
	</div></div></div></div>
<p class="para">库权限依赖于文件系统的权限。如果用户有读/写权限，他可以从库中检出或者提交到库。</p>
</div></div>
</div></div>
<div class="sect3 sect" id="access-via-webdav"><div class="inner">
<div class="hgroup"><h3 class="title">通过 WebDAV 协议 (http://) 访问</h3></div>
<div class="region"><div class="contents">
<p class="para">
                          To access the Subversion repository via WebDAV protocol, you must configure your Apache 2 web server. Add the following snippet between the 
                          <span class="em emphasis">&lt;VirtualHost&gt;</span> and <span class="em emphasis">&lt;/VirtualHost&gt;</span> elements in
                          <span class="file filename">/etc/apache2/sites-available/000-default.conf</span>, or another VirtualHost file:
                          </p>
<div class="code"><pre class="contents "> &lt;Location /svn&gt;
  DAV svn
  SVNParentPath /path/to/repos
  AuthType Basic
  AuthName "Your repository name"
  AuthUserFile /etc/subversion/passwd
  Require valid-user
 &lt;/Location&gt; 
</pre></div>
<div class="note" title="备注"><div class="inner"><div class="region"><div class="contents">
		<p class="para">The above configuration snippet assumes that Subversion
    repositories are created under <span class="file filename">/path/to/repos</span>
    directory using <span class="cmd command">svnadmin</span> command and that the HTTP user has sufficent access rights to the files (see below).  They can be
    accessible using <span class="cmd command">http://hostname/svn/repos_name</span>
    url.</p>
    </div></div></div></div>
<p class="para">
         Changing the apache configuration like the above requires to reload
         the service with the following command
         </p>
<div class="screen"><pre class="contents ">    <span class="cmd command">sudo service apache2 reload</span>
</pre></div>
<p class="para">
         To import or commit files to your Subversion repository over
         HTTP, the repository should be owned by the HTTP user. In
         Ubuntu systems, the HTTP user is
         <span class="cmd command">www-data</span>.  To change the ownership of the
         repository files enter the following command from terminal
         prompt:
         </p>
<div class="screen"><pre class="contents ">    <span class="cmd command">sudo chown -R www-data:www-data /path/to/repos</span>
</pre></div>
<div class="note" title="备注"><div class="inner"><div class="region"><div class="contents">
        <p class="para">将版本库的所有者修改为<span class="cmd command">www-data</span>后，你不能用除<span class="cmd command">www-data</span>以外的用户运行<span class="cmd command">svn import file:///</span>命令来导出或提交文件。</p>
        </div></div></div></div>
<p class="para">然后, 你必须创建文件<span class="file filename">/etc/subversion/passwd</span>来存放用户验证的详细信息. 在命令提示符后面输入下面的命令:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo htpasswd -c /etc/subversion/passwd user_name</span>
</pre></div>
<p class="para">添加附加的用户时请省略<span class="em emphasis">"-c"</span>选项，因为这个选项将用来替换旧的文件。应该使用这个形式来代替：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo htpasswd /etc/subversion/passwd user_name</span>
</pre></div>
<p class="para">该命令将提示您输入密码。一旦您输入密码。该用户将被添加。现在您可以运行下列命令来访问库：</p>
<div class="screen"><pre class="contents "><span class="cmd command">svn co http://servername/svn</span></pre></div>
<div class="note note-warning" title="警告"><div class="inner"><div class="region"><div class="contents">
		<p class="para">该密码是以纯文本传输的。如果您担心密码被截取，建议您使用 SSL 加密。相关细节，请参考下一章节。</p>
	</div></div></div></div>
</div></div>
</div></div>
<div class="sect3 sect" id="access-via-webdav-with-ssl"><div class="inner">
<div class="hgroup"><h3 class="title">通过带有 SSL 加密的 WebDAV 协议来访问 (https://)</h3></div>
<div class="region"><div class="contents">
<p class="para"> 
					Accessing Subversion repository via WebDAV protocol with SSL 
					encryption (https://) is similar to http:// except that you 
					must install and configure the digital certificate in your 
					Apache2 web server.  To use SSL with Subversion add the above
                                        Apache2 configuration to <span class="file filename">/etc/apache2/sites-available/default-ssl.conf</span>.
                                        For more information on setting up Apache2 with SSL see <a class="xref" href="httpd.html#https-configuration" title="HTTPS 配置">HTTPS 配置</a>.
					</p>
<p class="para">您可以安装一个权威机构发行的数字证书。当然，您也可以安装一个自定义的证书。</p>
<p class="para">这一步假设您已经在您的 Apache2 web 服务器中安装和配置了数字证书。现在要访问 Subversion 库，请参考上一章节！除了所用协议之外访问方式完全相同。您必须使用 https:// 来访问 Subversion 库。</p>
</div></div>
</div></div>
<div class="sect3 sect" id="access-via-custom-protocol"><div class="inner">
<div class="hgroup"><h3 class="title">通过自身协议访问 (svn://)</h3></div>
<div class="region"><div class="contents">
<p class="para">一旦 Subversion 库被创建，您就可以配置访问控制了。您可以通过编辑 <span class="file filename"> /path/to/repos/project/conf/svnserve.conf</span> 文件来配置访问控制了。例如，要设置认证，您可以在配置文件中反注释下列行：</p>
<div class="code"><pre class="contents "># [general]
# password-db = passwd</pre></div>
<p class="para">在反注释上面几行之后，您可以在 passwd 文件中维护用户列表。因此编辑同一目录中的文件 <span class="file filename">passwd </span>并添加新用户。其语法如下：</p>
<div class="code"><pre class="contents ">username = password</pre></div>
<p class="para">更多细节，请参考该文件。</p>
<p class="para">现在要从本机或不同机器通过 svn:// 自身协议来访问 Subversion，您可以使用 svnserve 命令来运行 svnserver。其语法如下：</p>
<div class="code"><pre class="contents ">$ svnserve -d --foreground -r /path/to/repos
# -d -- daemon mode
# --foreground -- run in foreground (useful for debugging)
# -r -- root of directory to serve

For more usage details, please refer to:
$ svnserve --help</pre></div>
<p class="para">一旦您运行该命令，将启动 Subversion 并在缺省端口 (3690) 监听。要访问项目库，您必须在终端提示符后运行下列命令：</p>
<p class="para">
<div class="screen"><pre class="contents "><span class="cmd command">svn co svn://hostname/project project --username user_name</span>
</pre></div>
                                        </p>
<p class="para">根据服务器的配置，出现密码提示。一旦您认证通过，将从 Subversion 库检出代码。要让本地副本同步项目库，您可以运行 <span class="cmd command">update</span> 子命令。在终端提示符后的命令语法如下所示：</p>
<p class="para">
<div class="screen"><pre class="contents "><span class="cmd command">cd project_dir ; svn update</span>
</pre></div>
                                        </p>
<p class="para">关于 Subversion 子命令的更多细节，您可以参考手册。如为了学到关于 co (checkout) 命令的细节，请在终端提示符后运行下列命令：</p>
<p class="para"><div class="screen"><pre class="contents "><span class="cmd command">svn co help</span></pre></div></p>
</div></div>
</div></div>
<div class="sect3 sect" id="access-via-custom-protocol-with-ssh"><div class="inner">
<div class="hgroup"><h3 class="title">Access via custom protocol with SSH encryption (svn+ssh://)</h3></div>
<div class="region"><div class="contents">
<p class="para">配置和服务器处理与用 svn:// 方式是相同的。详情请参考上面的章节。这一步假定您已经完成了上面的步骤并用 <span class="app application">svnserve</span> 命令启动了 Subversion 服务器。</p>
<p class="para">它也假定 ssh 服务器已经在该机上运行并允许连接。为了确认，请尝试使用 ssh 登录该机器。如果您可以登录，一切就绪。如果不能登录，请在继续之前解决它。</p>
<p class="para">svn+ssh:// 协议使用 SSL 加密来访问 Subversion 库。使用这种方式进行的数据传输是加密的。要访问项目库 (如 checkout)，您必须使用下面的命令语法：</p>
<p class="para">
<div class="screen"><pre class="contents ">    <span class="cmd command">svn co svn+ssh://ssh_username@hostname/path/to/repos/project</span>
</pre></div>
                                        </p>
<div class="note" title="备注"><div class="inner"><div class="region"><div class="contents"><p class="para">使用这种访问方式您必须使用全路径 (/path/to/repos/project) 来访问 Subversion 库。</p></div></div></div></div>
<p class="para">根据服务器配置，它将提示输入密码。在使用 ssh 登录时您必须输入密码。一旦您被认证通过之后，它将从 Subversion 库中检出代码。</p>
</div></div>
</div></div>
</div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="git.html" title="Git">上一页</a><a class="nextlinks-next" href="version-control-ref.html" title="参考资料">下一页</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p></div>
</div>
</body>
</html>
