<!DOCTYPE html>
<html lang=pt-BR>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Certificados</title>
<link rel="stylesheet" type="text/css" href="pt_BR.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="http://www.ubuntu.com/partners">Partners</a></li>
<li><a href="http://www.ubuntu.com/support">Support</a></li>
<li><a href="http://www.ubuntu.com/community">Community</a></li>
<li><a href="http://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="http://community.ubuntu.com/contribute/documentation/">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../16.04" class="trail">Ubuntu 16.04</a> » <a class="trail" href="index.html" title="Guia para servidores Ubuntu">Guia para servidores Ubuntu</a> » <a class="trail" href="security.html" title="Segurança">Segurança</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="apparmor.html" title="AppArmor">Anterior</a><a class="nextlinks-next" href="ecryptfs.html" title="eCryptfs">Próximo</a>
</div>
<div class="hgroup"><h1 class="title">Certificados</h1></div>
<div class="region">
<div class="contents">
<p class="para">Uma das formais mais comuns de criptografia hoje é a criptografia de <span class="em emphasis">chave pública</span>. A criptografia de chave pública utiliza uma <span class="em emphasis">chave pública</span> e uma <span class="em emphasis">chave privada</span>. O funcionamento do sistema consiste em <span class="em emphasis">cifrar</span> informação usando a chave pública. A informação então só pode ser <span class="em emphasis">decifrada</span> usando a chave privada.</p>
<p class="para">
            A common use for public-key cryptography is encrypting application traffic using a Secure Socket Layer (SSL) or 
            Transport Layer Security (TLS) connection. One example: configuring Apache to provide <span class="em emphasis">HTTPS</span>, the
            HTTP protocol over SSL. This allows a way to encrypt traffic using a protocol that does not itself provide encryption.
            </p>
<p class="para">
            A <span class="em emphasis">Certificate</span> is a method used to distribute a <span class="em emphasis">public key</span> and other information
            about a server and the organization who is responsible for it. Certificates can be digitally signed by a 
            <span class="em emphasis">Certification Authority</span>, or CA. A CA is a trusted third party that has confirmed that the information
            contained in the certificate is accurate.
            </p>
</div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="certificates-and-security.html#types-of-certificates" title="Tipos de Certificados">Tipos de Certificados</a></li>
<li class="links"><a class="xref" href="certificates-and-security.html#generating-a-csr" title="Gerando uma Assinatura de Requisição de Certificado (CSR)">Gerando uma Assinatura de Requisição de Certificado (CSR)</a></li>
<li class="links"><a class="xref" href="certificates-and-security.html#creating-a-self-signed-certificate" title="Criando um certificado Auto-Assinado">Criando um certificado Auto-Assinado</a></li>
<li class="links"><a class="xref" href="certificates-and-security.html#installing-the-certificate" title="Instalando o Certificado">Instalando o Certificado</a></li>
<li class="links"><a class="xref" href="certificates-and-security.html#certificate-authority" title="Autoridade Certificadora">Autoridade Certificadora</a></li>
<li class="links"><a class="xref" href="certificates-and-security.html#certificate-references" title="Referências">Referências</a></li>
</ul></div>
<div class="sect2 sect" id="types-of-certificates"><div class="inner">
<div class="hgroup"><h2 class="title">Tipos de Certificados</h2></div>
<div class="region"><div class="contents">
<p class="para">Para configurar um servidor seguro usando a criptografia de chave pública, na maioria dos casos, você envia sua solicitação de certificado (incluindo sua chave pública), prova a identidade de sua empresa e paga uma CA. A CA verifica a solicitação de certificado e sua identidade e logo envia um certificado para seu servidor seguro. Como alternativa, você pode criar seu certificado <span class="em emphasis">auto-assinado</span>.</p>
<div class="note" title="Nota"><div class="inner"><div class="region"><div class="contents">
              <p class="para">
              Note that self-signed certificates should not be used in most production environments.
              </p>
            </div></div></div></div>
<p class="para">Continuando o exmplo HTTPS, um certificado CA-assinado fornece duas capacidades importantes que o certificado auto-assinado não fornece:</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
            <p class="para">Navegadores (em geral) automaticamente reconhecem o certificado e permitem uma conexão segura sem questionamentos ao usuário.</p>
            </li>
<li class="list itemizedlist">
            <p class="para">Quando um CA emite um certificado assinado, está garantindo a identidade da organização que está provendo as páginas da web para o navegador.</p>
            </li>
</ul></div>
<p class="para">
             Most Web browsers, and computers, that support SSL have a list of CAs whose
             certificates they automatically accept. If a browser
             encounters a certificate whose authorizing CA is not in the
             list, the browser asks the user to either accept or decline
             the connection. Also, other applications may generate an error message when using
             a self-signed certificate.
            </p>
<p class="para">O processo de obtenção de um certificado por um CA é bastante fácil. A seguir uma visão geral:</p>
<div class="list orderedlist"><ol class="list orderedlist">
<li class="list orderedlist">
               <p class="para">Cria um par de chaves criptográficas privada e pública.</p>
            </li>
<li class="list orderedlist">
                 <p class="para">Cria uma requisição de certificado baseada na chave pública. A requisição de certificado contém informação a respeito do seu servidor e da empresa que o hospeda.</p>
            </li>
<li class="list orderedlist">
                 <p class="para">Envie o pedido de certificado, juntamente com documentos provando sua identidade para a AC. Não podemos lhe dizer qual Autoridade Certificadora (AC) escolher. Sua decisão deve ser baseada nas suas experiências anteriores, na experiência de amigos ou colegas, ou puramente por fatores financeiros.</p>

                    <p class="para">Uma vez decido qual CA usar, você precisa seguir as instruções que eles disponibilizam em como obter um certificado deles.</p>
            </li>
<li class="list orderedlist">
               <p class="para">Quando o CA está satisfeito de que você é de fato quem diz ser, eles lhe enviam um certificado digital.</p>
            </li>
<li class="list orderedlist">
              <p class="para">Instala este certificado no seu servidor seguro, e configura as aplicações apropriadas para utilizar o certificado.</p>
            </li>
</ol></div>
</div></div>
</div></div>
<div class="sect2 sect" id="generating-a-csr"><div class="inner">
<div class="hgroup"><h2 class="title">Gerando uma Assinatura de Requisição de Certificado (CSR)</h2></div>
<div class="region"><div class="contents">
<p class="para">Não importa se está recebendo um certificado de um CA ou gerando o seu certificado auto-assinado, o primeiro passo é criar uma chave.</p>
<p class="para">       
          If the certificate will be used by service daemons, such as Apache, Postfix, Dovecot, etc., 
          a key without a passphrase is often appropriate. Not having a passphrase allows the services
          to start without manual intervention, usually the preferred way to start a daemon.
          </p>
<p class="para">Esta seção cobrirá  a criação de uma chave com uma frase secreta, e uma sem. A chave sem passphrase será então usada para gerar um certificado que pode ser usado com vários serviços de sistema.</p>
<div class="note note-warning" title="Aviso"><div class="inner"><div class="region"><div class="contents">
            <p class="para">Executar seu serviço de segurança  sem uma frase secreta é conveniente pois você não precisará entrá-la cada vez que iniciar seu serviço de segurança. Mas ela é insegura e um comprometimento da chave é um comprometimento do servidor também.</p>
          </div></div></div></div>
<p class="para">Para gerar a <span class="em emphasis">chave</span> para o Certificate Signing Request (CSR) execute o seguinte comando em um terminal:</p>
<div class="screen"><pre class="contents "><span class="cmd command">openssl genrsa -des3 -out server.key 2048</span>
</pre></div>
<div class="code"><pre class="contents ">Generating RSA private key, 2048 bit long modulus
..........................++++++
.......++++++
e is 65537 (0x10001)
Enter pass phrase for server.key:
</pre></div>
<p class="para">Agora, você pode inserir a sua senha. Para uma segurança melhor, ela deve conter no mínimo oito caracteres. O tamanho mínimo quando -des3 é especificado é de quatro caracteres. É bom incluir números e/ou pontuação e não ser uma palavra de dicionário. Também, lembre-se que a sua senha é sensível à caixa alta e/ ou baixa.</p>
<p class="para">Digite a combinação de palavras novamente para verificação. Após ter regiditado corretamente, a chave do servidor é gerada e armazenada no arquivo <span class="file filename">server.key</span>.</p>
<p class="para">Agora criada a chave insegura, a qual sem uma frase secreta, e embaralhe os nomes da chave:</p>
<div class="screen"><pre class="contents "><span class="cmd command">openssl rsa -in server.key -out server.key.insecure</span>
<span class="cmd command">mv server.key server.key.secure</span>
<span class="cmd command">mv server.key.insecure server.key</span>
</pre></div>
<p class="para">A chave insegura é agora chamada <span class="file filename">server.key</span>, e você pode usar este arquivo para gerar o CSR sem frase secreta.</p>
<p class="para">Para criar um CSR, execute o seguinte comando no prompt do terminal:</p>
<div class="screen"><pre class="contents "><span class="cmd command">openssl req -new -key server.key -out server.csr</span>
</pre></div>
<p class="para">Vai ser solicitado que você entre sua senha. Se você entrar com a senha correta, lhe serão solicitados o Nome da Companhia, o Site, Email, etc. Quando estes detalhes forem inseridos, o seu CSR será criado e armazenado no arquivo <span class="file filename">server.csr</span>.</p>
<p class="para">Agora você pode submeter o arquivo CSR para um CA para processamento. O CA irá usar este arquivo CSR e caracterizar o certificado. Por outro lado, você mesmo poderá auto assinar um certificado utilizando este CSR.</p>
</div></div>
</div></div>
<div class="sect2 sect" id="creating-a-self-signed-certificate"><div class="inner">
<div class="hgroup"><h2 class="title">Criando um certificado Auto-Assinado</h2></div>
<div class="region"><div class="contents">
<p class="para">Para criar um certificado auto-assinado, execute o seguinte comando no prompt de terminal:</p>
<div class="screen"><pre class="contents "><span class="cmd command">openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt</span>
</pre></div>
<p class="para">O comando abaixo irá lhe pedir uma senha. Assim que você informar a senha correta, seu certificado será criado e ele será armazenado no arquivo <span class="file filename">server.crt</span>.</p>
<div class="note note-warning" title="Aviso"><div class="inner"><div class="region"><div class="contents">
        <p class="para">Se o seu servidor seguro deve ser utilizado em um ambiente de produção, você provavelmente precisa de um certificado assinado por uma CA. Não é recomendado usar certificados auto-assinados.</p>
        </div></div></div></div>
</div></div>
</div></div>
<div class="sect2 sect" id="installing-the-certificate"><div class="inner">
<div class="hgroup"><h2 class="title">Instalando o Certificado</h2></div>
<div class="region"><div class="contents">
<p class="para">Você pode instalar o arquivo de chave <span class="file filename">server.key</span> e o arquivo do certificado <span class="file filename">server.crt</span>, ou o arquivo de certificado enviado pelo seu CA, executando os seguintes comandos no terminal:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo cp server.crt /etc/ssl/certs</span>
<span class="cmd command">sudo cp server.key /etc/ssl/private</span>
</pre></div>
<p class="para">Agora simplesmente configure qualquer aplicação, com a habilidade de usar chaves-publicas criptografadas, para usar os arquivos  <span class="em emphasis">certificate</span> e <span class="em emphasis">key</span>. Por exemplo, <span class="app application">Apache</span> pode prover HTTPS, <span class="app application">Dovecot</span> pode prover IMAPS e POP3S, etc.</p>
</div></div>
</div></div>
<div class="sect2 sect" id="certificate-authority"><div class="inner">
<div class="hgroup"><h2 class="title">Autoridade Certificadora</h2></div>
<div class="region"><div class="contents">
<p class="para">Se os serviços de sua rede exigirem mais do que alguns certificados auto-assinados pode valer a pena o esforço de se configurar uma <span class="em emphasis"> Autoridade Certificadora (AC) emphasis&gt; interna. Ao utilizar certificados assinados pela sua pr</span></p>
<div class="steps"><div class="inner"><ol class="steps">
<li class="steps">
  
              <p class="para">Em primeiro lugar, criar os diretórios para armazenar o certificado CA e arquivos relacionados:</p>    

<div class="screen"><pre class="contents "><span class="cmd command">sudo mkdir /etc/ssl/CA</span>
<span class="cmd command">sudo mkdir /etc/ssl/newcerts</span>
</pre></div>

            </li>
<li class="steps">
  
              <p class="para">O CA precisa de arquivos adcionais para operar , um para acompanhar o ultimo numero de série usado pelo CA , cada certificado deve ter uma chave única , e outro arquivo para gravar quais certificados foram usados.</p>    

<div class="screen"><pre class="contents "><span class="cmd command">sudo sh -c "echo '01' &gt; /etc/ssl/CA/serial"</span>
<span class="cmd command">sudo touch /etc/ssl/CA/index.txt</span>
</pre></div>

            </li>
<li class="steps">
  
              <p class="para">O terceiro arquivo é um arquivo de configuração CA. Embora não estritamente necessário, é muito conveniente quando se trabalha com certificados múltiplos. Edite <span class="file filename">/etc/ssl/openssl.cnf</span> e, em <span class="em emphasis">[ CA_default ]</span>, altere:</p>    

<div class="code"><pre class="contents ">dir             = /etc/ssl              # Where everything is kept
database        = $dir/CA/index.txt     # database index file.
certificate     = $dir/certs/cacert.pem # The CA certificate
serial          = $dir/CA/serial        # The current serial number
private_key     = $dir/private/cakey.pem# The private key
</pre></div>    

            </li>
<li class="steps">
  
              <p class="para">
              Next, create the self-signed root certificate:
              </p>    

<div class="screen"><pre class="contents "><span class="cmd command">openssl req -new -x509 -extensions v3_ca -keyout cakey.pem -out cacert.pem -days 3650</span>
</pre></div>

              <p class="para">Você será solicitado a digitar as informações sobre o certificado.</p>

            </li>
<li class="steps">
  
              <p class="para">Agora instale o certificado raiz e chave:</p>    

<div class="screen"><pre class="contents "><span class="cmd command">sudo mv cakey.pem /etc/ssl/private/</span>
<span class="cmd command">sudo mv cacert.pem /etc/ssl/certs/</span>
</pre></div>

            </li>
<li class="steps">
  
              <p class="para">Agora você está pronto para assinar certificados. O primeiro item necessário é uma CSR (Solicitação de Assinatura de Certificado), veja em <a class="xref" href="certificates-and-security.html#generating-a-csr" title="Gerando uma Assinatura de Requisição de Certificado (CSR)">Gerando uma Assinatura de Requisição de Certificado (CSR)</a> para maiores detalhes. Assim que possuir uma CSR, digite o seguinte para gerar um certificado assinado pela Autoridade Certificadora:</p>    

<div class="screen"><pre class="contents "><span class="cmd command">sudo openssl ca -in server.csr -config /etc/ssl/openssl.cnf</span>
</pre></div>

              <p class="para">Depois de entrar com com a senha para a chave CA  , será solicitado que você assinar um certificado , e mais uma vez se aceitar o novo certificado . Você deve então ver uma grande quantidade de saídas relacionadas a criação de certificado</p>

            </li>
<li class="steps">   

              <p class="para">Agora deveria haver um novo arquivo, <span class="file filename">/etc/ssl/newcerts/01.pem</span>, contendo a mesma saída. Copie e cole qualquer coisa começando com a linha: <span class="em emphasis">-----BEGIN CERTIFICATE-----</span> e continue até encontrar a linha: <span class="em emphasis">----END CERTIFICATE-----</span> para um arquivo nomeado antes do hostname do servidor onde o certificado será instalado. Por exemplo <span class="file filename">mail.example.com.crt</span>, é um bom nome descritivo.</p>

              <p class="para">Subseqüentemente os certificados serão nomeados <span class="file filename">02.pem</span>, <span class="file filename">03.pem</span>, etc.</p>

              <div class="note" title="Nota"><div class="inner"><div class="region"><div class="contents">
                <p class="para">Substituir <span class="em emphasis">mail.example.com.crt</span> com seu próprio nome descritivo.</p>
              </div></div></div></div>

            </li>
<li class="steps">
  
              <p class="para">Enfim , copie o novo certificado para o host que precisa desse certificado , e configure as aplicações apropriadas para usa-los . O local padrão de instalação dos certificados é <span class="file filename">/etc/ssl/certs</span>.Isso disponibiliza serviços múltiplos para o usar o mesmo certificado sem execessiva complicações de permissões de arquivos .</p>    

              <p class="para">Para aplicações que podem ser configuradas use um certificado CA, você deve copiar o arquivo <span class="file filename">/etc/ssl/certs/cacert.pem</span> para <span class="file filename">/etc/ssl/certs/</span> no diretório em cada servidor.</p>

            </li>
</ol></div></div>
</div></div>
</div></div>
<div class="sect2 sect" id="certificate-references"><div class="inner">
<div class="hgroup"><h2 class="title">Referências</h2></div>
<div class="region"><div class="contents"><div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
              <p class="para">
              For more detailed instructions on using cryptography see the
              <a href="http://tldp.org/HOWTO/SSL-Certificates-HOWTO/index.html" class="ulink" title="http://tldp.org/HOWTO/SSL-Certificates-HOWTO/index.html">SSL Certificates HOWTO</a> by tldp.org:
              </p>
            </li>
<li class="list itemizedlist">
              <p class="para">
              The Wikipedia <a href="http://en.wikipedia.org/wiki/HTTPS" class="ulink" title="http://en.wikipedia.org/wiki/HTTPS">HTTPS</a> page has more information regarding HTTPS.
              </p>
            </li>
<li class="list itemizedlist">
              <p class="para">Para mais informações sobre o emphasis&gt;OpenSSL</p>
            </li>
<li class="list itemizedlist">
              <p class="para">
              Also, O'Reilly's <a href="http://oreilly.com/catalog/9780596002701/" class="ulink" title="http://oreilly.com/catalog/9780596002701/">Network Security with OpenSSL</a> is a good
              in-depth reference.
              </p>
            </li>
</ul></div></div></div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="apparmor.html" title="AppArmor">Anterior</a><a class="nextlinks-next" href="ecryptfs.html" title="eCryptfs">Próximo</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p></div>
</div>
</body>
</html>
