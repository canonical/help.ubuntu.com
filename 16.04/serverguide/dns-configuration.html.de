<!DOCTYPE html>
<html lang=de>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Konfiguration</title>
<link rel="stylesheet" type="text/css" href="de.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="http://www.ubuntu.com/partners">Partners</a></li>
<li><a href="http://www.ubuntu.com/support">Support</a></li>
<li><a href="http://www.ubuntu.com/community">Community</a></li>
<li><a href="http://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="http://community.ubuntu.com/contribute/documentation/">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../16.04" class="trail">Ubuntu 16.04</a> » <a class="trail" href="index.html" title="Ubuntu–Server-Leitfaden">Ubuntu–Server-Leitfaden</a> » <a class="trail" href="dns.html" title="Domain Name Service (DNS)">Domain Name Service (DNS)</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="dns-installation.html" title="Installation">Zurück</a><a class="nextlinks-next" href="dns-troubleshooting.html" title="Fehlersuche">Weiter</a>
</div>
<div class="hgroup"><h1 class="title">Konfiguration</h1></div>
<div class="region">
<div class="contents">
<p class="para">Es gibt viele Möglichkeiten, <span class="app application">BIND9</span> zu konfigurieren. Einige der gängigsten Konfigurationen sind als ein »Caching Nameserver« (DNS-Server), primärer Master und als ein sekundärer Master.</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
	      <p class="para">Wenn es als »Caching-Server« konfiguriert ist, findet BIND9 die Antwort auf Namensanfragen und »erinnert« sich daran, wenn die Domain erneut angefragt wird.</p>
	    </li>
<li class="list itemizedlist">
	      <p class="para">Als »Primary Master« liest BIND9 die Daten für eine Zone aus einer Datei auf seinem Host und ist verantwortlich für diese Zone.</p>
	    </li>
<li class="list itemizedlist">
	      <p class="para">Als »Secondary Master« konfiguriert bekommt BIND9 die Zonendaten von einem anderen Nameserver, der für diese Zone verantwortlich ist.</p>
	    </li>
</ul></div>
</div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="dns-configuration.html#dns-configuration-overview" title="Überblick">Überblick</a></li>
<li class="links"><a class="xref" href="dns-configuration.html#dns-caching-configuration" title="Caching Nameserver">Caching Nameserver</a></li>
<li class="links"><a class="xref" href="dns-configuration.html#dns-primarymaster-configuration" title="Primary Master">Primary Master</a></li>
<li class="links"><a class="xref" href="dns-configuration.html#dns-secondarymaster-configuration" title="Secondary Master">Secondary Master</a></li>
</ul></div>
<div class="sect2 sect" id="dns-configuration-overview"><div class="inner">
<div class="hgroup"><h2 class="title">Überblick</h2></div>
<div class="region"><div class="contents">
<p class="para">Die DNS-Konfigurationsdateien sind im Ordner <span class="file filename">/etc/bind</span> abgelegt. Die primäre Konfigurationsdatei ist <span class="file filename">/etc/bind/named.conf</span>.</p>
<p class="para">Die Zeile <span class="em emphasis">einfügen</span> spezifiziert den Dateinamen, der die DNS-Optionen enthält. Die Zeile <span class="em emphasis">directory</span> in der Datei <span class="file filename">/etc/bind/named.conf.options</span> teilt DNS mit, wo nach Dateien gesucht werden soll. Alle Dateien, die BIND benutzt, werden relativ zu diesem Verzeichnis sein.</p>
<p class="para">Die Datei mit der Bezeichnung <span class="file filename">/etc/bind/db.root</span> beschreibt die weltweit verteilten Root-Nameserver. Da diese sich mit der Zeit ändern, muss die Datei <span class="file filename">/etc/bind/db.root</span> von Zeit zu Zeit aktualisiert werden. Dies wird normalerweise durch Aktualisierungen zum Paket <span class="app application">bind9</span> getan. Der Abschnitt <span class="em emphasis">zone</span> definiert einen Hauptserver und ist in einer Datei gespeichert, die in der  <span class="em emphasis">Datei</span>-Option aufgeführt ist.</p>
<p class="para">Es ist möglich, einen Server gleichzeitig als Caching Nameserver, Primary Master und Secondary Master zu konfigurieren. Ein Server kann der »Start of Authority« einer Zone sein, während er für eine andere Zone als Secondary Server arbeitet und Caching-Dienste für das lokale Netzwerk bereitstellt.</p>
</div></div>
</div></div>
<div class="sect2 sect" id="dns-caching-configuration"><div class="inner">
<div class="hgroup"><h2 class="title">Caching Nameserver</h2></div>
<div class="region"><div class="contents">
<p class="para">Die standardmäßige Konfiguration ist so eingerichtet, dass der Server als Caching Server arbeitet. Dazu ist es nur nötig, die IP-Adressen Ihrer ISP-DNS Server hinzuzufügen. EditierenSie die Datei <span class="file filename">/etc/bind/named.conf.options</span> und kommentierren Sie folgende Zeilen aus:</p>
<div class="code"><pre class="contents ">forwarders {
                1.2.3.4;
                5.6.7.8;
           };
</pre></div>
<div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
	    <p class="para">Ersetzen Sie <span class="em emphasis">1.2.3.4</span> und <span class="em emphasis">5.6.7.8</span> mit den IP-Adressen Ihrer tatsächlichen Nameserver.</p>
	  </div></div></div></div>
<p class="para">Starten Sie nun den DNS-Server neu, um die neue Konfiguration zu aktivieren. Geben Sie folgendes in ein Terminal ein:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo systemctl restart bind9.service</span>
</pre></div>
<p class="para">Weitere Informationen zum Testen eines Caching DNS-Servers finden Sie unter</p>
</div></div>
</div></div>
<div class="sect2 sect" id="dns-primarymaster-configuration"><div class="inner">
<div class="hgroup"><h2 class="title">Primary Master</h2></div>
<div class="region">
<div class="contents"><p class="para">In diesem Abschnitt wird <span class="app application">BIND9</span> als »Primary Master« für die Domain <span class="em emphasis">example.com</span> konfiguriert. Ersetzen Sie einfach <span class="em emphasis">example.com</span> mit dem vollständig qualifizierten Namen (FQDN) Ihrer Domäne.</p></div>
<div class="sect3 sect" id="dns-forward-zone-file"><div class="inner">
<div class="hgroup"><h3 class="title">Forward Zone File</h3></div>
<div class="region"><div class="contents">
<p class="para">Um eine DNS-Zone zu BIND9 hinzuzufügen (BIND9 wird »Primary Master«), muss zuerst die Datei <span class="file filename">/etc/bind/named.conf.local</span> editiert werden:</p>
<div class="code"><pre class="contents ">zone "example.com" {
	type master;
        file "/etc/bind/db.example.com";
};
</pre></div>
<p class="para">
	      (Note, if bind will be receiving automatic updates to the file as with DDNS, then use <span class="file filename">/var/lib/bind/db.example.com</span>
	      rather than <span class="file filename">/etc/bind/db.example.com</span> both here and in the copy command below.)
	      </p>
<p class="para">Benutzen Sie nun eine existierende Zonendatei als Vorlage, um die Datei <span class="file filename">/etc/bind/db.example.com</span> zu erstellen:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo cp /etc/bind/db.local /etc/bind/db.example.com</span>
</pre></div>
<p class="para">
	      Edit the new zone file <span class="file filename">/etc/bind/db.example.com</span> change <span class="em emphasis">localhost.</span>
	      to the FQDN of your server, leaving the additional "." at the end. Change <span class="em emphasis">127.0.0.1</span> to the 
	      nameserver's IP Address and <span class="em emphasis">root.localhost</span> to a valid email address, but with a "." instead 
	      of the usual "@" symbol, again leaving the "." at the end. Change the comment to indicate the domain that this
	      file is for.
	      </p>
<p class="para">
	      Create an <span class="em emphasis">A record</span> for the base domain, <span class="em emphasis">example.com</span>.
	      Also, create an <span class="em emphasis">A record</span> for <span class="em emphasis">ns.example.com</span>, the name 
	      server in this example: 
	      </p>
<div class="code"><pre class="contents ">;
; BIND data file for example.com
;
$TTL    604800
@       IN      SOA     example.com. root.example.com. (
                              2         ; Serial
                         604800         ; Refresh
                          86400         ; Retry
                        2419200         ; Expire
                         604800 )       ; Negative Cache TTL
        IN      A       192.168.1.10
;
@       IN      NS      ns.example.com.
@       IN      A       192.168.1.10
@       IN      AAAA    ::1
ns      IN      A       192.168.1.10
</pre></div>
<p class="para">Immer, wenn Sie Änderungen an der Zonendatei durchführen, müssen Sie die <span class="em emphasis">Serial-Nummer</span> erhöhen. Wenn Sie mehrere Änderungen durchführen, bevor Sie BIND9 neu starten, ist nur die Erhöhung der Serial-Nummer um einen Schritt (und nicht mehrere) notwendig.</p>
<p class="para">Nun können Sie DNS-Aufzeichnungen an das untere Ende der Zonendatei anfügen. Für weitere Details siehe <a class="xref" href="dns-references.html#dns-record-types" title="Gebräuchliche Record-Typen">Gebräuchliche Record-Typen</a>.</p>
<div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
	         <p class="para">
	         Many admins like to use the last date edited as the serial of a zone, such as  <span class="em emphasis">2012010100</span>
	         which is yyyymmddss (where <span class="em emphasis">ss</span> is the Serial Number)
		 </p>
	       </div></div></div></div>
<p class="para">
	       Once you have made changes to the zone file <span class="app application">BIND9</span> needs to be restarted for 
	       the changes to take effect: 
	       </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo systemctl restart bind9.service</span>
</pre></div>
</div></div>
</div></div>
<div class="sect3 sect" id="dns-reverse-zone-file"><div class="inner">
<div class="hgroup"><h3 class="title">Reverse Zone File</h3></div>
<div class="region"><div class="contents">
<p class="para">Nachdem die Zone erstellt wurde und Namen in IP-Adressen auflöst, wird ebenfalls eine <span class="em emphasis">»Reverse Zone«</span> benötigt. Eine solche »Reverse Zone« erlaubt es DNS, eine Adresse in einen Namen aufzulösen.</p>
<p class="para">Bearbeiten Sie /etc/bind/named.conf.local und fügen Sie folgendes hinzu:</p>
<div class="code"><pre class="contents ">zone "1.168.192.in-addr.arpa" {
        type master;
        file "/etc/bind/db.192";
};
</pre></div>
<div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
	        <p class="para">Ersetzen Sie <span class="em emphasis">1.168.192</span> mit den ersten drei Oktetts des von Ihnen benutzten Netzwerks. Benennen Sie auch die Zonendatei <span class="file filename">/etc/bind/db.192</span> zweckentsprechend. Sie sollte mit dem ersten Oktett Ihres Netzwerks zusammenpassen.</p>
	      </div></div></div></div>
<p class="para">Erstellen Sie nun die Datei <span class="file filename">/etc/bind/db.192</span>:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo cp /etc/bind/db.127 /etc/bind/db.192</span>
</pre></div>
<p class="para">Bearbeiten Sie danach die Datei <span class="file filename">/etc/bind/db.192</span>, indem Sie die gleichen Optionen ändern,
 wie in <span class="file filename">/etc/bind/db.example.com</span>:</p>
<div class="code"><pre class="contents ">;
; BIND reverse data file for local 192.168.1.XXX net
;
$TTL    604800
@       IN      SOA     ns.example.com. root.example.com. (
                              2         ; Serial
                         604800         ; Refresh
                          86400         ; Retry
                        2419200         ; Expire
                         604800 )       ; Negative Cache TTL
;
@       IN      NS      ns.
10      IN      PTR     ns.example.com.
</pre></div>
<p class="para">
	      The <span class="em emphasis">Serial Number</span> in the Reverse zone needs to be incremented on each change as well. 
	      For each <span class="em emphasis">A record</span> you configure in <span class="file filename">/etc/bind/db.example.com</span>, that is for a different
	      address, you need to create a <span class="em emphasis">PTR record</span> in <span class="file filename">/etc/bind/db.192</span>.
	      </p>
<p class="para">Nachdem Sie die Zonendatei für die »Reverse Zone« erstellt haben, starten Sie <span class="app application">BIND9</span> neu:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo systemctl restart bind9.service</span>
</pre></div>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="dns-secondarymaster-configuration"><div class="inner">
<div class="hgroup"><h2 class="title">Secondary Master</h2></div>
<div class="region"><div class="contents">
<p class="para">Sobald ein <span class="em emphasis">Primary Master</span> konfiguriert wurde, wird ein <span class="em emphasis">Secondary Master</span> benötigt, um die Erreichbarkeit der Domäne sicherzustellen, falls der Primary Master nicht zur Verfügung steht.</p>
<p class="para">Zuerst muss auf dem Primary Master der Zonentransfer erlaubt werden. Fügen Sie die Option <span class="em emphasis">allow-transfer</span> zu den im Beispiel behandelten Definitionen der Zonen in <span class="file filename">/etc/bind/named.conf.local</span>:</p>
<div class="code"><pre class="contents ">zone "example.com" {
        type master;
	file "/etc/bind/db.example.com";
        allow-transfer { 192.168.1.11; };
};

zone "1.168.192.in-addr.arpa" {
        type master;
        file "/etc/bind/db.192";
	allow-transfer { 192.168.1.11; };
};
</pre></div>
<div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
	      <p class="para">Ersetzen Sie <span class="em emphasis">192.168.1.11</span> mit der IP-Adresse Ihres »Secondary« Nameservers.</p>
            </div></div></div></div>
<p class="para">
            Restart <span class="app application">BIND9</span> on the Primary Master:
	    </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo systemctl restart bind9.service</span>
</pre></div>
<p class="para">Installieren Sie dann auf dem Secondary Master das Paket <span class="app application">bind9</span> auf die gleiche Weise wie auf dem Primary Master. Bearbeiten Sie dann die Datei <span class="file filename">/etc/bind/named.conf.local</span> und fügen Sie folgende Deklarationen für die Forward und Reverse Zone hinzu:</p>
<div class="code"><pre class="contents ">zone "example.com" {
	type slave;
        file "db.example.com";
        masters { 192.168.1.10; };
};        
      
zone "1.168.192.in-addr.arpa" {
	type slave;
        file "db.192";
        masters { 192.168.1.10; };
};
</pre></div>
<div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
	      <p class="para">Ersetzen Sie <span class="em emphasis">192.168.1.10</span> mit der IP-Adresse Ihres Primary Nameservers.</p>
            </div></div></div></div>
<p class="para">Starten Sie <span class="app application">BIND9</span> auf dem Secondary Master neu:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo systemctl restart bind9.service</span>
</pre></div>
<p class="para">
	    In <span class="file filename">/var/log/syslog</span> you should see something similar to (some lines have been split to fit the format of this document):
	    </p>
<div class="code"><pre class="contents ">client 192.168.1.10#39448: received notify for zone '1.168.192.in-addr.arpa'
zone 1.168.192.in-addr.arpa/IN: Transfer started.
transfer of '100.18.172.in-addr.arpa/IN' from 192.168.1.10#53:
 connected using 192.168.1.11#37531
zone 1.168.192.in-addr.arpa/IN: transferred serial 5
transfer of '100.18.172.in-addr.arpa/IN' from 192.168.1.10#53:
 Transfer completed: 1 messages, 
6 records, 212 bytes, 0.002 secs (106000 bytes/sec)
zone 1.168.192.in-addr.arpa/IN: sending notifies (serial 5)

client 192.168.1.10#20329: received notify for zone 'example.com'
zone example.com/IN: Transfer started.
transfer of 'example.com/IN' from 192.168.1.10#53: connected using 192.168.1.11#38577
zone example.com/IN: transferred serial 5
transfer of 'example.com/IN' from 192.168.1.10#53: Transfer completed: 1 messages, 
8 records, 225 bytes, 0.002 secs (112500 bytes/sec)
</pre></div>
<div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
	      <p class="para">
              Note: A zone is only transferred if the <span class="em emphasis">Serial Number</span> on the Primary is larger than the one on the Secondary. If you want to have your Primary Master DNS notifying Secondary DNS Servers of zone changes, you can add <span class="em emphasis">also-notify { ipaddress; };</span> in to <span class="file filename">/etc/bind/named.conf.local</span> as shown in the example below:
	      </p>
	    </div></div></div></div>
<div class="code"><pre class="contents ">zone "beispiel.de" {
	type master;
	file "/etc/bind/db.example.com";
	allow-transfer { 192.168.1.11; };
	also-notify { 192.168.1.11; }; 
	};

zone "1.168.192.in-addr.arpa" {
	type master;
	file "/etc/bind/db.192";
	allow-transfer { 192.168.1.11; };
	also-notify { 192.168.1.11; }; 
	};
	</pre></div>
<div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
	      <p class="para">Die Vorgabe für das Verzeichnis für nicht-autoritative Zonen-Dateien ist <span class="file filename">/var/cache/bind/</span>. Dieses Verzeichnis ist auch in <span class="app application">AppArmor</span> so konfiguriert, dass der <span class="app application">named</span>-Hintergrunddienst hinein schreiben darf. Um weitere Informationen zu AppArmor zu erhalten, sehen Sie hier nach: <a class="xref" href="apparmor.html" title="AppArmor">AppArmor</a>.</p>
	    </div></div></div></div>
</div></div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="dns-installation.html" title="Installation">Zurück</a><a class="nextlinks-next" href="dns-troubleshooting.html" title="Fehlersuche">Weiter</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p></div>
</div>
</body>
</html>
