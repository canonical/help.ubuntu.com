<!DOCTYPE html>
<html lang=de>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Firewall</title>
<link rel="stylesheet" type="text/css" href="de.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="http://www.ubuntu.com/partners">Partners</a></li>
<li><a href="http://www.ubuntu.com/support">Support</a></li>
<li><a href="http://www.ubuntu.com/community">Community</a></li>
<li><a href="http://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="http://community.ubuntu.com/contribute/documentation/">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../16.04" class="trail">Ubuntu 16.04</a> » <a class="trail" href="index.html" title="Ubuntu–Server-Leitfaden">Ubuntu–Server-Leitfaden</a> » <a class="trail" href="security.html" title="Sicherheit">Sicherheit</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="console-security.html" title="Sicherheit im Terminal">Zurück</a><a class="nextlinks-next" href="apparmor.html" title="AppArmor">Weiter</a>
</div>
<div class="hgroup"><h1 class="title">Firewall</h1></div>
<div class="region">
<div class="contents"></div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="firewall.html#firewall-introduction" title="Einleitung">Einleitung</a></li>
<li class="links"><a class="xref" href="firewall.html#firewall-ufw" title="ufw – unkomplizierte Firewall">ufw – unkomplizierte Firewall</a></li>
<li class="links"><a class="xref" href="firewall.html#ip-masquerading" title="IP-Masquerading">IP-Masquerading</a></li>
<li class="links"><a class="xref" href="firewall.html#firewall-logs" title="Protokolle">Protokolle</a></li>
<li class="links"><a class="xref" href="firewall.html#other-firewall-tools" title="Weitere Werkzeuge">Weitere Werkzeuge</a></li>
<li class="links"><a class="xref" href="firewall.html#firewall-references" title="Referenzen">Referenzen</a></li>
</ul></div>
<div class="sect2 sect" id="firewall-introduction"><div class="inner">
<div class="hgroup"><h2 class="title">Einleitung</h2></div>
<div class="region"><div class="contents">
<p class="para">Der Linux-Kernel enthält das <span class="em emphasis">Netzfilter</span></p>
<p class="para">
              The kernel's packet filtering system would be of little use to administrators without
			  a userspace interface to manage it. This is the purpose of iptables: When a packet
			  reaches your server, it will be handed off to the Netfilter subsystem for acceptance,
			  manipulation, or rejection based on the rules supplied to it from userspace via
			  iptables. Thus, iptables is all you need to manage your firewall, if you're familiar
			  with it, but many frontends are available to simplify the task.
            </p>
</div></div>
</div></div>
<div class="sect2 sect" id="firewall-ufw"><div class="inner">
<div class="hgroup"><h2 class="title">ufw – unkomplizierte Firewall</h2></div>
<div class="region">
<div class="contents">
<p class="para">
	    The default firewall configuration tool for Ubuntu is <span class="app application">ufw</span>. Developed to ease iptables firewall configuration,
	    <span class="app application">ufw</span> provides a user-friendly way to create an IPv4 or IPv6 host-based firewall.
	    </p>
<p class="para"><span class="app application">ufw</span> ist standardmäßig deaktiviert. Zitat aus der <span class="app application">ufw</span>-Manpage:</p>
<p class="para">
<span class="quote">»ufw ist nicht dazu gedacht, eine komplette Firewallfunktionalität über seine Befehlsschnittstelle zu liefern. Stattdessen liefert es einen leichten Weg, einfache Regeln hinzuzufügen oder zu entfernen. Es wird gegenwärtig hauptsächlich für Host-basierte Firewalls benutzt.«</span>
	    </p>
<p class="para">Im folgenden einige Beispiele zur Benutzung von <span class="app application">ufw</span>.</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
                <p class="para">Zuerst muss <span class="app application">ufw</span> aktiviert werden. Geben Sie hierzu in ein Terminal ein:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw enable</span>
</pre></div>
	      </li>
<li class="list itemizedlist">
                <p class="para">
                To open a port (SSH in this example):
	        </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw allow 22</span>
</pre></div>
	      </li>
<li class="list itemizedlist">
                <p class="para">Regeln können auch in einem <span class="em emphasis">nummerierten</span> Format hinzugefügt werden.</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw insert 1 allow 80</span>
</pre></div>
	      </li>
<li class="list itemizedlist">
                <p class="para">Um einen Port zu schließen:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw deny 22</span>
</pre></div>
	      </li>
<li class="list itemizedlist">
                <p class="para">Um eine Regel zu löschen, benutzen Sie »delete«, gefolgt von der Regel:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw delete deny 22</span>
</pre></div>
	      </li>
<li class="list itemizedlist">
                <p class="para">
		It is also possible to allow access from specific hosts or networks to a port. The following example allows SSH access
		from host 192.168.0.2 to any IP address on this host:
	        </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw allow proto tcp from 192.168.0.2 to any port 22</span>
</pre></div>
	        <p class="para">
		Replace 192.168.0.2 with 192.168.0.0/24 to allow SSH access from the entire subnet.
		</p>
	      </li>
<li class="list itemizedlist">

                <p class="para">Das Hinzufügen der Option <span class="em emphasis">--dry-run</span> zu einem <span class="em emphasis">ufw</span>-Befehl bewirkt, dass die resultierenden Regeln ausgegeben, aber nicht angewendet werden. Folgendes würde angewendet werden, wenn der HTTP-Port geöffnet werden würde:</p>

<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw --dry-run allow http</span>
</pre></div>

<div class="screen"><pre class="contents "><span class="output computeroutput">*filter
:ufw-user-input - [0:0]
:ufw-user-output - [0:0]
:ufw-user-forward - [0:0]
:ufw-user-limit - [0:0]
:ufw-user-limit-accept - [0:0]
### RULES ###

### tuple ### allow tcp 80 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 80 -j ACCEPT

### END RULES ###
-A ufw-user-input -j RETURN
-A ufw-user-output -j RETURN
-A ufw-user-forward -j RETURN
-A ufw-user-limit -m limit --limit 3/minute -j LOG --log-prefix "[UFW LIMIT]: "
-A ufw-user-limit -j REJECT
-A ufw-user-limit-accept -j ACCEPT
COMMIT
Rules updated</span>
</pre></div>

              </li>
<li class="list itemizedlist">
                <p class="para"><span class="app application">ufw</span> kann wie folgt deaktiviert werden:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw disable</span>
</pre></div>
	      </li>
<li class="list itemizedlist">
                <p class="para">Um den Firewallstatus anzuzeigen, geben Sie folgendes ein:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw status</span>
</pre></div>
	      </li>
<li class="list itemizedlist">
                <p class="para">Um weiterführende Statusinformationen einzusehen, geben Sie ein:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw status verbose</span>
</pre></div>
	      </li>
<li class="list itemizedlist">
                <p class="para">Um das <span class="em emphasis">nummerierte</span> Format zu sehen:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw status numbered</span>
</pre></div>
	      </li>
</ul></div>
<div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
	      <p class="para">Wenn der Port, den Sie öffnen oder schließen möchten, in <span class="file filename">/etc/services</span> definiert ist, können Sie anstatt der Nummer den Portnamen benutzen. In den obigen Beispielen können Sie <span class="em emphasis">22</span> mit <span class="em emphasis">ssh</span> ersetzen.</p>
	    </div></div></div></div>
<p class="para">Dies ist nur eine kurze Vorstellung von <span class="app application">ufw</span>. Weiterführende Informationen finden Sie in der <span class="app application">ufw</span>-Manpage.</p>
</div>
<div class="sect3 sect" id="ufw-application-integration"><div class="inner">
<div class="hgroup"><h3 class="title">ufw-Anwendungsintegration</h3></div>
<div class="region"><div class="contents">
<p class="para">Anwendungen, die Ports öffnen, können ein <span class="app application">ufw</span>-Profil beinhalten, das die zur einwandfreien Funktion der Anwendung benötigten Ports spezifiziert. Die Profile sind in <span class="file filename">/etc/ufw/applications.d</span> enthalten und können editiert werden, falls die Standard-Ports sich geändert haben.</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">

                  <p class="para">Um zu sehen, welche Anwendungen ein Profil installiert haben, geben Sie das folgende in ein Terminal ein:</p>

<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw app list</span>
</pre></div>

                </li>
<li class="list itemizedlist">

                  <p class="para">Entsprechend der Freigabe eines Ports, wird die Benutzung eines Anwendungsprofils durch folgende Eingabe erreicht:</p>

<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw allow Samba</span>
</pre></div>

                </li>
<li class="list itemizedlist">

                  <p class="para">Es ist auch eine erweiterte Syntax verfügbar:</p>

<div class="screen"><pre class="contents "><span class="cmd command">ufw allow from 192.168.0.0/24 to any app Samba</span>
</pre></div>

                  <p class="para">Ersetzen Sie <span class="em emphasis">Samba</span> und <span class="em emphasis">192.168.0.0/24</span> mit dem benutzten Anwendungsprofil bzw. des IP-Bereichs Ihres Netzwerks.</p>

                  <div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
                    <p class="para">Es ist nicht notwendig, das <span class="em emphasis">protocol</span> für die Anwendung zu spezifizieren, da diese Information im Profil angegeben ist. Beachten Sie auch, dass der <span class="em emphasis">app</span>-Name die Port-Nummer ersetzt.</p>
                  </div></div></div></div>

                </li>
<li class="list itemizedlist">

                  <p class="para">
                  To view details about which ports, protocols, etc., are defined for an application, enter:
                  </p>

<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw app info Samba</span>
</pre></div>

                </li>
</ul></div>
<p class="para">
              Not all applications that require opening a network port come with <span class="app application">ufw</span> profiles, but if 
              you have profiled an application and want the file to be included with the package, please file a bug against the 
              package in Launchpad.
              </p>
<div class="screen"><pre class="contents "><span class="cmd command">ubuntu-bug namedespakets</span>
</pre></div>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="ip-masquerading"><div class="inner">
<div class="hgroup"><h2 class="title">IP-Masquerading</h2></div>
<div class="region">
<div class="contents"><p class="para">Der Zweck der IP-Masquerading ist es, Maschinen in Ihrem Netz, die private, nicht-weiterleitbare IP-Adressen besitzen, zu erlauben, das Internet über eine Maschine, die die Adressen übersetzt, zu erreichen. Der Verkehr, der von Ihrem privaten Netz ins Internet gelenkt wird, muss dabei in einer Weise manipuliert werden, damit die Antworten wieder zu der Maschine zurück geleitet werden können, die sie angefordert hat. Um dies zu bewerkstelligen, muss der Kernel die <span class="em emphasis">ursprüngliche</span> IP-Adresse eines jeden Paketes so verändern, dass die Antworten an diese Maschine zurückgesendet werden, anstatt der privaten IP-Adresse die die Anfragen gemacht hat, die vom Internet nicht erreichbar ist. Linux benutzt dazu <span class="em emphasis">Verbindungsüberwachung</span> (conntrack) um festzustellen, welche Verbindung zu welcher Maschine gehört und dementsprechend jedes Paket an die richtige Adresse weiterzuleiten. Der Verkehr der Ihr privates  Netz verlässt ist damit »maskiert«, als ob sie von der Ubuntu Gateway Maschine herstammt. Dieser Prozess wird in den Microsoft-Beschreibungen als »Internetverbindungsfreigabe« beschrieben.</p></div>
<div class="sect3 sect" id="ip-masquerade-ufw"><div class="inner">
<div class="hgroup"><h3 class="title">ufw-Masquerading</h3></div>
<div class="region"><div class="contents">
<p class="para">IP-Masquerading kann durch benutzerdefinierte <span class="app application">ufw</span>-Regeln erreicht werden. Dies ist möglich, weil <span class="app application">iptables-restore</span> mit den Regeln in den Dateien <span class="file filename">/etc/ufw/*.rules</span> das derzeitige Backend für <span class="app application">ufw</span> ist. Diese Dateien sind ein guter Platz, um zusätzliche iptables-Regeln hinzuzufügen, die ohne <span class="app application">ufw</span> benutzt werden und Regeln die mehr auf Netzwerk-Gateway- oder -brücken ausgerichtet sind.</p>
<p class="para">Die Regeln sind in zwei Dateien aufgeteilt. In Regeln, die vor <span class="app application">ufw</span>-Befehlszeilenregeln, und in Regeln, die nach <span class="app application">ufw</span>-Befehlszeilenregeln ausgeführt werden.</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
		  <p class="para">Zuerst muss die Paketweiterleitung in <span class="app application">ufw</span> aktiviert werden. Hierzu müssen zwei Konfigurationsdateien geändert werden. Ändern Sie in der Datei <span class="file filename">/etc/default/ufw</span> die <span class="em emphasis">DEFAULT_FORWARD_POLICY</span> in <span class="quote">»ACCEPT«</span>:</p>
<div class="code"><pre class="contents ">DEFAULT_FORWARD_POLICY="ACCEPT"
</pre></div>
		  <p class="para">Danach ändern Sie <span class="file filename">/etc/ufw/sysctl.conf</span> und kommentieren folgendes aus:</p>
<div class="code"><pre class="contents ">net/ipv4/ip_forward=1
</pre></div>
		  <p class="para">Entsprechend für die IPv6-Weiterleitung (auskommentieren):</p>
<div class="code"><pre class="contents ">net/ipv6/conf/default/forwarding=1
</pre></div>
		</li>
<li class="list itemizedlist">
		  <p class="para">
		  Now add rules to the <span class="file filename">/etc/ufw/before.rules</span> file. The default rules only configure the <span class="em emphasis">filter</span>
	          table, and to enable masquerading the <span class="em emphasis">nat</span> table will need to be configured. Add the following to the top of the file
		  just after the header comments:	          
		  </p>
<div class="code"><pre class="contents "># nat Table rules
*nat
:POSTROUTING ACCEPT [0:0]

# Forward traffic from eth1 through eth0.
-A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE

# don't delete the 'COMMIT' line or these nat table rules won't be processed
COMMIT
</pre></div>
	          <p class="para">Die Kommentare sind nicht unbedingt notwendig. Es ist aber eine bewährte Praxis, die Konfigurationen auf diese Weise zu dokumentieren. Wenn Sie eine der <span class="em emphasis">Regel</span>-Dateien in <span class="file filename">/etc/ufw</span> ändern, so stellen Sie sicher, dass die folgenden Zeilen immer die letzten in jeder geänderten Tabelle sind:</p>

<div class="code"><pre class="contents "># don't delete the 'COMMIT' line or these rules won't be processed
COMMIT
</pre></div>

                  <p class="para">Für jede <span class="em emphasis">Tabelle</span> wird eine korrespondierender <span class="em emphasis">COMMIT</span>-Anweisung benötigt. In diesen Beispielen werden nur die <span class="em emphasis">nat</span>- und <span class="em emphasis">filter</span>-Tabellen gezeigt. Sie können ebenfalls Regeln für die <span class="em emphasis">raw</span>- und <span class="em emphasis">mangle</span>-Tabellen hinzufügen.</p>

                  <div class="note" title="Anmerkung"><div class="inner"><div class="region"><div class="contents">
                   <p class="para">Ersetzen Sie <span class="em emphasis">eth0</span>, <span class="em emphasis">eth1</span> und <span class="em emphasis">192.168.0.0/24</span> im obigen Beispiel mit den entsprechenden Schnittstellen und dem IP-Bereich Ihres Netzwerks.</p>
                  </div></div></div></div>

		</li>
<li class="list itemizedlist">
		  <p class="para">Deaktivieren und aktivieren Sie schlussendlich <span class="app application">ufw</span>, um die Änderungen anzuwenden:</p>
<div class="code"><pre class="contents "><span class="cmd command">sudo ufw disable &amp;&amp; sudo ufw enable</span>
</pre></div>
		</li>
</ul></div>
<p class="para">IP-Masquerading sollte nun aktiviert sein. Sie können auch jede zusätzliche Weiterleitungsregel zur Datei <span class="file filename">/etc/ufw/before.rules</span> hinzufügen. Es wird empfohlen, dass diese zusätzlichen Regeln zur <span class="em emphasis">ufw-before-forward</span>-Kette hinzugefügt werden.</p>
</div></div>
</div></div>
<div class="sect3 sect" id="ip-masquerading-iptables"><div class="inner">
<div class="hgroup"><h3 class="title">iptables-Masquerading</h3></div>
<div class="region"><div class="contents">
<p class="para">
	    <span class="app application">iptables</span> can also be used to enable Masquerading.  
	    </p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
  	        <p class="para">
 	        Similar to <span class="app application">ufw</span>, the first step is to enable IPv4 packet forwarding by editing 
		<span class="file filename">/etc/sysctl.conf</span> and uncomment the following line:
	        </p>
<div class="code"><pre class="contents ">net.ipv4.ip_forward=1
</pre></div>
	        <p class="para">Wenn Sie IPv6-Weiterleitung ebenfalls aktivieren möchten, dann sollten Sie folgendes zusätzlich auskommentieren:</p>
<div class="code"><pre class="contents ">net.ipv6.conf.default.forwarding=1
</pre></div>
 	      </li>
<li class="list itemizedlist">
		  <p class="para">Danach führen Sie den Befehl <span class="app application">sysctl</span> aus, um die neuen Einstellungen in der Konfigurationsdatei zu aktivieren:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo sysctl -p</span>
</pre></div>
		</li>
<li class="list itemizedlist">
	        <p class="para">Das IP-Masquerading kann nun mit einer einzelnen iptables-Regel erreicht werden, die abhängig von Ihrer Netzwerkkonfiguration leicht von der folgenden Ausgabe abweichen kann:</p>
<div class="screen"><pre class="contents ">sudo iptables -t nat -A POSTROUTING -s 192.168.0.0/16 -o ppp0 -j MASQUERADE
</pre></div>
	        <p class="para">Der obige Befehl setzt voraus, dass Ihr privater Adressraum 192.168.0.0/16 ist und dass Ihr Verbindungsgerät zum Internet ppp0 ist. Die Syntax ist folgendermaßen aufgebaut:</p>
		<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist"><p class="para">-t nat -- Die Regel wird in die NAT-Tabelle eingefügt</p></li>
<li class="list itemizedlist"><p class="para">-A POSTROUTING -- Die Regel soll an die POSTROUTING-Kette angehängt (-A) werden.</p></li>
<li class="list itemizedlist"><p class="para">-s 192.168.0.0/16 -- Die Regel trifft für den Verkehr zu, der von dem angegebenen Adressraum herstammt</p></li>
<li class="list itemizedlist"><p class="para">-o ppp0 -- Die Regel trifft für den Verkehr zu, der durch das angegeben Netzwerkgerät geleitet wird</p></li>
<li class="list itemizedlist">
                    <p class="para">-j MASQUERADE -- Der Verkehr auf den diese Regel zutrifft, wird dem Ziel "MASQUERADE"  zugeleitet und dort wie vorher beschrieben manipuliert</p>
                  </li>
</ul></div>
	      </li>
<li class="list itemizedlist">
		<p class="para">Jede Kette in der Tabelle (Standardtabelle und wo die Filterung der meisten oder aller Pakete stattfindet) hat ebenfalls eine »ACCEPT«-Standardstrategie. Wenn Sie aber zusätzlich zu einem Gateway-Gerät eine Firewall erstellen, haben Sie diese Strategie vermutlich auf »DROP« oder »REJECT« eingestellt. In diesem Fall muss Ihr maskierter Verkehr durch die »FORWARD«-Kette zugelassen werden, damit die obige Regel funktioniert:</p>
<div class="screen"><pre class="contents ">sudo iptables -A FORWARD -s 192.168.0.0/16 -o ppp0 -j ACCEPT
sudo iptables -A FORWARD -d 192.168.0.0/16 -m state \
--state ESTABLISHED,RELATED -i ppp0 -j ACCEPT
</pre></div>
		<p class="para">Die obigen Befehle erlauben alle Verbindungen von Ihrem lokalen Netzwerk ins Internet und lassen jeden Verkehr, der mit diesen Verbindungen zusammenhängt, zu der initiierenden Maschine zurück laufen.</p>
	      </li>
<li class="list itemizedlist">
		<p class="para">Wenn Sie möchten, dass Maskerade nach dem Neustart aktiviert ist, editieren Sie <span class="file filename">/etc/rc.local</span> und fügen Sie alle oben benutzten Befehle hinzu. Beispielsweise den ersten Befehl ohne Filterung:</p>
<div class="screen"><pre class="contents ">iptables -t nat -A POSTROUTING -s 192.168.0.0/16 -o ppp0 -j MASQUERADE
</pre></div>
	      </li>
</ul></div>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="firewall-logs"><div class="inner">
<div class="hgroup"><h2 class="title">Protokolle</h2></div>
<div class="region"><div class="contents">
<p class="para">Firewallprotokolle sind essentiell für die Erkennung von Angriffen, die Fehlersuche in Ihren Firewallregeln und zur Wahrnehmung unüblicher Aktivitäten in Ihrem Netzwerk. Sie müssen Regeln für die Erstellung von Protokollen in Ihrer Firewall aufnehmen. Diese Protokollierungsregeln müssen vor jeder zutreffenden Begrenzungsregel (eine Regel mit einem Ziel, das dass Schicksal eines Pakets bestimmt, wie »ACCEPT«, »DROP«, oder »REJECT«) angewendet werden.</p>
<p class="para">Wenn Sie <span class="app application">ufw</span> benutzen, können Sie die Protokollierung mit folgendem Befehl in einem Terminal aktivieren:</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo ufw logging on</span>
</pre></div>
<p class="para">Um die Protokollierung in <span class="app application">ufw</span> abzuschalten, ersetzen Sie im obigen Befehl einfach <span class="em emphasis">on</span> mit <span class="em emphasis">off</span>.</p>
<p class="para">Wenn Sie statt <span class="app application">ufw</span> <span class="app application">iptables</span> benutzen, geben Sie folgendes ein:</p>
<div class="screen"><pre class="contents ">sudo iptables -A INPUT -m state --state NEW -p tcp --dport 80 \
-j LOG --log-prefix "NEW_HTTP_CONN: "
</pre></div>
<p class="para">
	     A request on port 80 from the local machine, then, would generate a log in dmesg
	     that looks like this (single line split into 3 to fit this document):
	     </p>
<div class="code"><pre class="contents ">[4304885.870000] NEW_HTTP_CONN: IN=lo OUT= MAC=00:00:00:00:00:00:00:00:00:00:00:00:08:00
SRC=127.0.0.1 DST=127.0.0.1 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=58288 DF PROTO=TCP
SPT=53981 DPT=80 WINDOW=32767 RES=0x00 SYN URGP=0
</pre></div>
<p class="para">
              The above log will also appear in <span class="file filename">/var/log/messages</span>,
			  <span class="file filename">/var/log/syslog</span>, and <span class="file filename">/var/log/kern.log</span>.
			  This behavior can be modified by editing <span class="file filename">/etc/syslog.conf</span>
			  appropriately or by installing and configuring <span class="app application">ulogd</span>
			  and using the ULOG target instead of LOG. The <span class="app application">ulogd</span>
			  daemon is a userspace server that listens for logging instructions from the kernel
			  specifically for firewalls, and can log to any file you like, or even to a
			  <span class="app application">PostgreSQL</span> or <span class="app application">MySQL</span>
			  database.  Making sense of your firewall logs can be simplified by using a log
			  analyzing tool such as <span class="app application">logwatch</span>, <span class="app application">fwanalog</span>,
			  <span class="app application">fwlogwatch</span>, or <span class="app application">lire</span>.
            </p>
</div></div>
</div></div>
<div class="sect2 sect" id="other-firewall-tools"><div class="inner">
<div class="hgroup"><h2 class="title">Weitere Werkzeuge</h2></div>
<div class="region"><div class="contents">
<p class="para">Es stehen viele Werkzeuge zur Verfügung, die Ihnen helfen, eine komplette Firewall ohne tiefe Kenntnisse von »iptables« aufzubauen. Für diejenigen, die eine grafische Benutzeroberfläche bevorzugen:</p>
<div class="list itemizedlist"><ul class="list itemizedlist"><li class="list itemizedlist">
		<p class="para"><a href="http://www.fwbuilder.org/" class="ulink" title="http://www.fwbuilder.org/">fwbuilder</a> ist sehr mächtig und ist dem Administrator vertraut, der schon ein kommerzielles Firewallwerkzeug, wie <span class="app application">Checkpoint FireWall-1</span> benutzt hat.</p>
	      </li></ul></div>
<p class="para">Wenn Sie ein Befehlszeilenwerkzeug mit Klartext-Konfigurationsdateien bevorzugen:</p>
<div class="list itemizedlist"><ul class="list itemizedlist"><li class="list itemizedlist">
		<p class="para"><a href="http://www.shorewall.net/" class="ulink" title="http://www.shorewall.net/">Shorewall</a> ist eine sehr mächtige Lösung, um Ihnen bei der Konfiguration einer erweiterten Firewall für jedes Netzwerk zu helfen.</p>
	      </li></ul></div>
</div></div>
</div></div>
<div class="sect2 sect" id="firewall-references"><div class="inner">
<div class="hgroup"><h2 class="title">Referenzen</h2></div>
<div class="region"><div class="contents"><div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
	      <p class="para">
	      The <a href="https://wiki.ubuntu.com/UncomplicatedFirewall" class="ulink" title="https://wiki.ubuntu.com/UncomplicatedFirewall">Ubuntu Firewall</a> wiki page contains information on the development
	      of <span class="app application">ufw</span>.
	      </p>
	    </li>
<li class="list itemizedlist">
	      <p class="para">Die <span class="app application">ufw</span>-Manpage-Seite enthält einige sehr nützliche Informationen: <span class="cmd command">man ufw</span>.</p>
	    </li>
<li class="list itemizedlist">
	      <p class="para">Weitere Informationen zur Benutzung von <span class="app application">iptables</span> finden Sie unter <a href="http://www.netfilter.org/documentation/HOWTO/packet-filtering-HOWTO.html" class="ulink" title="http://www.netfilter.org/documentation/HOWTO/packet-filtering-HOWTO.html">packet-filtering-HOWTO</a>.</p>
	    </li>
<li class="list itemizedlist">
	      <p class="para">Weitere Details über das Masquerading finden Sie unter <a href="http://www.netfilter.org/documentation/HOWTO/NAT-HOWTO.html" class="ulink" title="http://www.netfilter.org/documentation/HOWTO/NAT-HOWTO.html">nat-HOWTO</a></p>
	    </li>
<li class="list itemizedlist">
	      <p class="para">Das <a href="https://help.ubuntu.com/community/IptablesHowTo" class="ulink" title="https://help.ubuntu.com/community/IptablesHowTo">IPTables-HowTo</a> im Ubuntu-Wiki ist eine großartige Quelle.</p>
	    </li>
</ul></div></div></div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="console-security.html" title="Sicherheit im Terminal">Zurück</a><a class="nextlinks-next" href="apparmor.html" title="AppArmor">Weiter</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p></div>
</div>
</body>
</html>
