<!DOCTYPE html>
<html lang=zh-CN>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Mailman</title>
<link rel="stylesheet" type="text/css" href="zh_CN.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="https://partners.ubuntu.com">Partners</a></li>
<li><a href="https://www.ubuntu.com/support/community-support">Support</a></li>
<li><a href="https://community.ubuntu.com">Community</a></li>
<li><a href="https://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="https://community.ubuntu.com/t/contribute/26">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../16.04" class="trail">Ubuntu 16.04</a> » <a class="trail" href="index.html" title="Ubuntu 服务器指南">Ubuntu 服务器指南</a> » <a class="trail" href="email-services.html" title="邮件服务">邮件服务</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="dovecot-server.html" title="Dovecot 服务器">上一页</a><a class="nextlinks-next" href="mail-filtering.html" title="邮件过滤">下一页</a>
</div>
<div class="hgroup"><h1 class="title">Mailman</h1></div>
<div class="region">
<div class="contents"><p class="para">Mailman 是一个管理电子邮件讨论及电子通讯列表的开源程序。许多开源的邮件列表 (包括所有的 <a href="http://lists.ubuntu.com" class="ulink" title="http://lists.ubuntu.com">Ubuntu 邮件列表</a>)使用 Mailman 作为他们的邮件列表软件。它是强大的且易于安装和维护。</p></div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="mailman.html#mailman-installation" title="安装">安装</a></li>
<li class="links"><a class="xref" href="mailman.html#mailman-configuration" title="配置">配置</a></li>
<li class="links"><a class="xref" href="mailman.html#mailman-admin" title="管理">管理</a></li>
<li class="links"><a class="xref" href="mailman.html#mailman-users" title="用户">用户</a></li>
<li class="links"><a class="xref" href="mailman.html#mailman-references" title="参考资料">参考资料</a></li>
</ul></div>
<div class="sect2 sect" id="mailman-installation"><div class="inner">
<div class="hgroup"><h2 class="title">安装</h2></div>
<div class="region">
<div class="contents">
<p class="para">
			Mailman provides a web interface for the administrators and users,
			using an external mail server to send and receive emails. It works
			perfectly with the following mail servers:
            </p>
<p class="para">
            <div class="list itemizedlist"><ul class="list itemizedlist compact">
<li class="list itemizedlist">
                    <p class="para"><span class="app application">Postfix</span></p>
                </li>
<li class="list itemizedlist">
                    <p class="para"><span class="app application">Exim</span></p>
                </li>
<li class="list itemizedlist">
                    <p class="para"><span class="app application">Sendmail</span></p>
                </li>
<li class="list itemizedlist">
                    <p class="para"><span class="app application">Qmail</span></p>
                </li>
</ul></div>
            </p>
<p class="para">
            We will see how to install and configure Mailman with, the Apache web server,
            and either the Postfix or Exim mail server. If you wish to install Mailman
            with a different mail server, please refer to the references
            section. 
            </p>
<div class="note" title="备注"><div class="inner"><div class="region"><div class="contents">
	       <p class="para">
		You only need to install one mail server and <span class="app application">Postfix</span> is the default Ubuntu Mail Transfer Agent.
	       </p>
	     </div></div></div></div>
</div>
<div class="sect3 sect" id="mailman-apache2"><div class="inner">
<div class="hgroup"><h3 class="title">Apache2</h3></div>
<div class="region"><div class="contents"><p class="para">
                To install apache2 you refer to <a class="xref" href="httpd.html#http-installation" title="安装">安装</a> for details.
              </p></div></div>
</div></div>
<div class="sect3 sect" id="mailman-postfix"><div class="inner">
<div class="hgroup"><h3 class="title">Postfix</h3></div>
<div class="region"><div class="contents"><p class="para">
	    For instructions on installing and configuring Postfix refer to <a class="xref" href="postfix.html" title="Postfix">Postfix</a>
	    </p></div></div>
</div></div>
<div class="sect3 sect" id="mailman-exim4"><div class="inner">
<div class="hgroup"><h3 class="title">Exim4</h3></div>
<div class="region"><div class="contents">
<p class="para">
              To install Exim4 refer to <a class="xref" href="exim4.html" title="Exim4">Exim4</a>.
	      </p>
<p class="para">
	      Once exim4 is installed, the configuration files are stored in
	      the <span class="file filename">/etc/exim4</span> directory. In Ubuntu, by default, the exim4 configuration files are
	      split across different files. You can change this behavior by changing
	      the following variable in the <span class="file filename">/etc/exim4/update-exim4.conf</span> file:
          </p>
<div class="code"><pre class="contents ">dc_use_split_config='true'
</pre></div>
</div></div>
</div></div>
<div class="sect3 sect" id="mailman-mailman"><div class="inner">
<div class="hgroup"><h3 class="title">Mailman</h3></div>
<div class="region"><div class="contents">
<p class="para">
              To install <span class="app application">Mailman</span>, run following command at a terminal prompt:
	      </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo apt install mailman</span> 
</pre></div>
<p class="para">
	     It copies the installation files in
	     <span class="app application">/var/lib/mailman</span> directory. It installs the
	     CGI scripts in <span class="app application">/usr/lib/cgi-bin/mailman</span>
	     directory.  It creates <span class="em emphasis">list</span> linux
	     user. It creates the <span class="em emphasis">list</span> linux
 	     group. The mailman process will be owned by this user. 
             </p>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="mailman-configuration"><div class="inner">
<div class="hgroup"><h2 class="title">配置</h2></div>
<div class="region">
<div class="contents"><p class="para">
            This section assumes you have successfully installed
            <span class="app application">mailman</span>,
            <span class="app application">apache2</span>, and
	    <span class="app application">postfix</span> or <span class="app application">exim4</span>. Now you just need
            to configure them. 
            </p></div>
<div class="sect3 sect" id="mailman-conf-apache2"><div class="inner">
<div class="hgroup"><h3 class="title">Apache2</h3></div>
<div class="region"><div class="contents">
<p class="para">
	      An example Apache configuration file comes with <span class="app application">Mailman</span> and is placed
	      in <span class="file filename">/etc/mailman/apache.conf</span>. In order for Apache to use the config file it needs
	      to be copied to <span class="file filename">/etc/apache2/sites-available</span>:
	      </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo cp /etc/mailman/apache.conf /etc/apache2/sites-available/mailman.conf</span>
</pre></div>
<p class="para">
	      This will setup a new Apache <span class="em emphasis">VirtualHost</span> for the Mailman administration site.
	      Now enable the new configuration and restart Apache:
	      </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo a2ensite mailman.conf</span>
<span class="cmd command">sudo systemctl restart apache2.service</span>
</pre></div>
<p class="para">
	      Mailman uses apache2 to render its CGI scripts. The mailman CGI scripts
	      are installed in the <span class="app application">/usr/lib/cgi-bin/mailman</span>
	      directory. So, the mailman url will be
	      http://hostname/cgi-bin/mailman/. You can make changes to the
	      <span class="file filename">/etc/apache2/sites-available/mailman.conf</span> file if you wish to
	      change this behavior.
              </p>
</div></div>
</div></div>
<div class="sect3 sect" id="mailman-conf-postfix"><div class="inner">
<div class="hgroup"><h3 class="title">Postfix</h3></div>
<div class="region"><div class="contents">
<p class="para">
	    For <span class="app application">Postfix</span> integration, we will associate the domain lists.example.com with the mailing lists.
	    Please replace <span class="em emphasis">lists.example.com</span> with the domain of your choosing.
	    </p>
<p class="para">
	    You can use the postconf command to add the necessary configuration to <span class="file filename">/etc/postfix/main.cf</span>:
	    </p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo postconf -e 'relay_domains = lists.example.com'</span>
<span class="cmd command">sudo postconf -e 'transport_maps = hash:/etc/postfix/transport'</span>
<span class="cmd command">sudo postconf -e 'mailman_destination_recipient_limit = 1'</span>
</pre></div>
<p class="para">
	  In <span class="file filename">/etc/postfix/master.cf</span> double check that you have the following transport:
	  </p>
<div class="code"><pre class="contents ">mailman   unix  -       n       n       -       -       pipe
  flags=FR user=list argv=/usr/lib/mailman/bin/postfix-to-mailman.py
  ${nexthop} ${user}
</pre></div>
<p class="para">当有邮件发送到一个列表时，它会调用<span class="em emphasis">postfix-to-mailman.py</span>脚本。</p>
<p class="para">用传送图将域名lists.example.com与Mailman传送连接起来。请编辑文件<span class="file filename">/etc/postfix/transport</span>：</p>
<div class="code"><pre class="contents ">lists.example.com      mailman:
</pre></div>
<p class="para">然后在终端输入如下命令来用<span class="app application">Postfix</span>构建传送图：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo postmap -v /etc/postfix/transport</span>
</pre></div>
<p class="para">然后重启Postfix以启用新的配置：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo systemctl restart postfix.service</span>
</pre></div>
</div></div>
</div></div>
<div class="sect3 sect" id="mailman-conf-exim4"><div class="inner">
<div class="hgroup"><h3 class="title">Exim4</h3></div>
<div class="region"><div class="contents">
<p class="para">当Exim4安装以后，你可以在终端输入如下命令以启动Exim服务器：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo systemctl start exim4.service</span>
</pre></div>
<p class="para">要使mailman能够与Exim4协同工作，你需要配置Exim4。如早前提过的，Exim4默认情况下是使用不同文件类型的多种配置文件。详细内容请查看<a href="http://www.exim.org" class="ulink" title="http://www.exim.org">Exim</a>网站。要运行mailman，我们要向如下配置类型里添加一个新的配置文件：<div class="list itemizedlist"><ul class="list itemizedlist compact">
<li class="list itemizedlist">
                <p class="para">主</p>
              </li>
<li class="list itemizedlist">
                <p class="para">传输</p>
              </li>
<li class="list itemizedlist">
                <p class="para">路由器</p>
              </li>
</ul></div> Exim通过搜选这些迷你配置文件来创建一个主配置文件。因此，这些配置文件罗列的顺序是非常重要的。</p>
</div></div>
</div></div>
<div class="sect3 sect" id="mailman-conf-main"><div class="inner">
<div class="hgroup"><h3 class="title">主</h3></div>
<div class="region"><div class="contents"><p class="para">所有隶属于主类别的配置文件都被保存在 <span class="file filename">/etc/exim4/conf.d/main/</span> 目录中。您可以将下面的内容添加到一个名为 <span class="file filename">04_exim4-config_mailman</span> 的新文件中：<div class="code"><pre class="contents "># start

# Home dir for your Mailman installation -- aka Mailman's prefix

# directory.

# On Ubuntu this should be "/var/lib/mailman"

# This is normally the same as ~mailman

MM_HOME=/var/lib/mailman

#

# User and group for Mailman, should match your --with-mail-gid

# switch to Mailman's configure script. Value is normally "mailman"

MM_UID=list

MM_GID=list

#

# Domains that your lists are in - colon separated list

# you may wish to add these into local_domains as well

domainlist mm_domains=hostname.com

#
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
#
# These values are derived from the ones above and should not need
# editing unless you have munged your mailman installation
#
# The path of the Mailman mail wrapper script
MM_WRAP=MM_HOME/mail/mailman
#
# The path of the list config file (used as a required file when
# verifying list addresses)
MM_LISTCHK=MM_HOME/lists/${lc::$local_part}/config.pck
# end
</pre></div></p></div></div>
</div></div>
<div class="sect3 sect" id="mailman-conf-transport"><div class="inner">
<div class="hgroup"><h3 class="title">传输</h3></div>
<div class="region"><div class="contents"><p class="para">所有隶属于传输类型的文件被保存在 <span class="file filename">/etc/exim4/conf.d/transport/</span> 目录中。您可以将下面的内容添加到一个名为 <span class="file filename">40_exim4-config_mailman</span> 的新文件中：<div class="code"><pre class="contents ">  mailman_transport:
   driver = pipe
   command = MM_WRAP \
               '${if def:local_part_suffix \
                     {${sg{$local_part_suffix}{-(\\w+)(\\+.*)?}{\$1}}} \
                     {post}}' \
               $local_part
    current_directory = MM_HOME
    home_directory = MM_HOME
    user = MM_UID
    group = MM_GID
</pre></div></p></div></div>
</div></div>
<div class="sect3 sect" id="mailman-conf-router"><div class="inner">
<div class="hgroup"><h3 class="title">路由器</h3></div>
<div class="region"><div class="contents">
<p class="para">所有隶属于路由类的所有配置文件都被保存在 <span class="file filename">/etc/exim4/conf.d/router/</span> 目录中。您可以将下列内容添加到名为 <span class="file filename">101_exim4-config_mailman</span> 的新文件中：<div class="code"><pre class="contents ">  mailman_router:
   driver = accept
   require_files = MM_HOME/lists/$local_part/config.pck
   local_part_suffix_optional
   local_part_suffix = -bounces : -bounces+* : \
                       -confirm+* : -join : -leave : \
                       -owner : -request : -admin
   transport = mailman_transport
</pre></div></p>
<div class="note note-warning" title="警告"><div class="inner"><div class="region"><div class="contents">
<p class="para">主类和传输类的配置文件的顺序可以随意。但路由类的配置文件的顺序必须相同。该文件必须在 <span class="app application">200_exim4-config_primary</span> 文件之前出现。如果两个配置文件包含相同类型的信息。第一个文件优先。详情请参阅参考部分。</p>
</div></div></div></div>
</div></div>
</div></div>
<div class="sect3 sect" id="mailman-conf-mailman"><div class="inner">
<div class="hgroup"><h3 class="title">Mailman</h3></div>
<div class="region"><div class="contents">
<p class="para">当mailman安装之后，你可以使用如下命令来运行它：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo systemctl start mailman.service</span>
</pre></div>
<p class="para">当mailman安装以后，你可以创建默认的邮件列表。运行如下命令来创建邮件列表：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo /usr/sbin/newlist mailman</span>
</pre></div>
<div class="code"><pre class="contents ">  Enter the email address of the person running the list: bhuvan at ubuntu.com
  Initial mailman password:
  To finish creating your mailing list, you must edit your <span class="file filename">/etc/aliases</span> (or
  equivalent) file by adding the following lines, and possibly running the
  `newaliases' program:

  ## mailman mailing list
  mailman: "|/var/lib/mailman/mail/mailman post mailman"
  mailman-admin: "|/var/lib/mailman/mail/mailman admin mailman"
  mailman-bounces: "|/var/lib/mailman/mail/mailman bounces mailman"
  mailman-confirm: "|/var/lib/mailman/mail/mailman confirm mailman"
  mailman-join: "|/var/lib/mailman/mail/mailman join mailman"
  mailman-leave: "|/var/lib/mailman/mail/mailman leave mailman"
  mailman-owner: "|/var/lib/mailman/mail/mailman owner mailman"
  mailman-request: "|/var/lib/mailman/mail/mailman request mailman"
  mailman-subscribe: "|/var/lib/mailman/mail/mailman subscribe mailman"
  mailman-unsubscribe: "|/var/lib/mailman/mail/mailman unsubscribe mailman"


  Hit enter to notify mailman owner...

  # 
</pre></div>
<p class="para">我们已经配置了Postfix或Exim4以查看来自mailman的所有邮件。因此，你不用必须在<span class="file filename">/etc/aliases</span>里添加新的条目了。如果你对配置文件做过了更改，请确保在进入下一环节之前已重启过这些服务。</p>
<div class="note" title="备注"><div class="inner"><div class="region"><div class="contents">
         <p class="para">因为Exim4使用<span class="em emphasis">发现</span> 机制，所以它不使用以上的别名将邮件转发给Mailman。要在创建列表时禁止别名，你可以将<span class="em emphasis">MTA=None</span>添加到Mailman的配置文件<span class="file filename">/etc/mailman/mm_cfg.py</span>中。</p>
         </div></div></div></div>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="mailman-admin"><div class="inner">
<div class="hgroup"><h2 class="title">管理</h2></div>
<div class="region"><div class="contents">
<p class="para">我们假设您是默认安装。mailman 的 cgi 脚本还在 <span class="app application">/usr/lib/cgi-bin/mailman/</span> 目录中。mailman 提供了一个基于 web 的管理工具。若想访问这个页面，请将您的浏览器指向以下 url：</p>
<p class="para">http://hostname/cgi-bin/mailman/admin</p>
<p class="para">默认的邮件列表 <span class="em emphasis">mailman</span> 会在这个屏幕中出现。如果您点击邮件列表的名称，它会向您询问通行密码。如果您输入了正确的密码，您就可以修改这个邮件列表的管理设定。您可以使用命令行工具来创建新的邮件列表(<span class="cmd command">/usr/sbin/newlist</span>)。或者您也可以使用 web 界面</p>
</div></div>
</div></div>
<div class="sect2 sect" id="mailman-users"><div class="inner">
<div class="hgroup"><h2 class="title">用户</h2></div>
<div class="region"><div class="contents">
<p class="para">Mailman 为用户提供了一个 web 界面，可以在您的浏览器中输入下列 url 来访问该页：</p>
<p class="para">http://hostname/cgi-bin/mailman/listinfo</p>
<p class="para">缺省邮件列表 <span class="em emphasis">mailman</span> 将出现在屏幕上。如果您点击邮件列表名，它将显示订阅表单。您可以输入您的邮件地址、姓名 (可选)及密码来订阅。一个邀请邮件将发送给您。您可以根据该邮件的指示完成订阅。</p>
</div></div>
</div></div>
<div class="sect2 sect" id="mailman-references"><div class="inner">
<div class="hgroup"><h2 class="title">参考资料</h2></div>
<div class="region"><div class="contents">
<p class="para">
<a href="http://www.list.org/mailman-install/index.html" class="ulink" title="http://www.list.org/mailman-install/index.html">GNU Mailman - 安装手册</a>
</p>
<p class="para">
<a href="http://www.exim.org/howto/mailman21.html" class="ulink" title="http://www.exim.org/howto/mailman21.html">指南 - 一起使用 Exim 4 和 Mailman 2.1</a>
</p>
<p class="para">
          Also, see the <a href="https://help.ubuntu.com/community/Mailman" class="ulink" title="https://help.ubuntu.com/community/Mailman">Mailman Ubuntu Wiki</a> page.
          </p>
</div></div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="dovecot-server.html" title="Dovecot 服务器">上一页</a><a class="nextlinks-next" href="mail-filtering.html" title="邮件过滤">下一页</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer"><p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p></div>
</div>
</body>
</html>
