<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>3.7. Pre-Installation Hardware and Operating System Setup</title>
<link rel="stylesheet" type="text/css" href="install.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="index.html" title="Ubuntu Installation Guide">
<link rel="up" href="ch03.html" title="Chapter 3. Before Installing Ubuntu">
<link rel="prev" href="ch03s06.html" title="3.6. Pre-Partitioning for Multi-Boot Systems">
<link rel="next" href="ch04.html" title="Chapter 4. Obtaining System Installation Media">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">3.7. Pre-Installation Hardware and Operating System Setup</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch03s06.html"><img src="images/prev.png" alt="Prev"></a> </td>
<th width="60%" align="center">Chapter 3. Before Installing Ubuntu</th>
<td width="20%" align="right"> <a accesskey="n" href="ch04.html"><img src="images/next.png" alt="Next"></a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title">
<a name="pre-install-bios-setup"></a>3.7. Pre-Installation Hardware and Operating System Setup</h2></div></div></div>
<p>

This section will walk you through pre-installation hardware setup, if
any, that you will need to do prior to installing Ubuntu.
Generally, this involves checking and possibly changing BIOS/system firmware settings for
your system. The <span class="quote">“<span class="quote">BIOS</span>”</span> or <span class="quote">“<span class="quote">system firmware</span>”</span> is the core software used by the
hardware; it is most critically invoked during the bootstrap process (after power-up).


</p>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="invoking-openfirmware"></a>3.7.1. Invoking OpenFirmware</h3></div></div></div>
<p>

There is normally no need to set up the BIOS (called OpenFirmware) on
<span class="phrase">PowerPC</span> systems. PReP and CHRP are equipped with OpenFirmware,
but unfortunately, the means you use to invoke it vary from
manufacturer to manufacturer.  You'll have to consult the hardware
documentation which came with your machine.

</p>
<p>

On <span class="phrase">PowerPC</span> Macintoshes, you invoke OpenFirmware with
<span class="keycap"><strong>Command (cloverleaf/Apple)</strong></span>+<span class="keycap"><strong>Option</strong></span>+<span class="keycap"><strong>o</strong></span>+<span class="keycap"><strong>f</strong></span>
while booting.  Generally it will check for these keystrokes after the
chime, but the exact timing varies from model to model.  See
<a class="ulink" href="http://www.netbsd.org/Ports/macppc/faq.html" target="_top">http://www.netbsd.org/Ports/macppc/faq.html</a> for more hints.

</p>
<p>

The OpenFirmware prompt looks like this:

</p>
<div class="informalexample"><pre class="screen">
ok
0 &gt;
</pre></div>
<p>

Note that on older model <span class="phrase">PowerPC</span> Macs, the default and sometimes
hardwired I/O for OpenFirmware user interaction is through the serial
(modem) port. If you invoke OpenFirmware on one of these machines, you
will just see a black screen. In that case, a terminal program running
on another computer, connected to the modem port, is needed to
interact with OpenFirmware.

</p>
<p>

The OpenFirmware on OldWorld Beige G3 machines, OF versions 2.0f1
and 2.4, is broken. These machines will most likely not be able to
boot from the hard drive unless the firmware is patched. A firmware
patch is included in the <span class="application">System Disk 2.3.1</span>
utility, available from Apple at
<a class="ulink" href="ftp://ftp.apple.com/developer/macosxserver/utilities/SystemDisk2.3.1.smi.bin" target="_top">ftp://ftp.apple.com/developer/macosxserver/utilities/SystemDisk2.3.1.smi.bin</a>.
After unpacking the utility in MacOS, and launching it, select the
<span class="guibutton">Save</span> button to have the firmware patches
installed to nvram.

</p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="update-firmware"></a>3.7.2. How to update bare metal ppc64el firmware</h3></div></div></div>
<p>

This is an excerpt from
<a class="ulink" href="https://www.ibm.com/developerworks/linux/tutorials/l-ibm-powerkvm-system-bring-up/" target="_top">IBM PowerKVM on IBM POWER8</a>.

</p>
<p>

Open Power Abstraction Layer (OPAL) is the system firmware in the stack
of POWER processor-based server.

</p>
<p>

There may be instances when the user might have to upgrade the Power
Systems firmware to a more recent level to acquire new features or
additional support for devices.

</p>
<p>

Make sure that the following requirements are met:

</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
    an OS to be running on the system;
</p></li>
<li class="listitem"><p>
    the .img file of the OPAL level that the user needs to update to;
</p></li>
<li class="listitem"><p>
    the machine isn't under HMC control.
</p></li>
</ul></div>
<p>
</p>
<p>

Power Systems has two sides of flash to boot firmware from, namely
permanent and temporary. This provides a way to test firmware updates on
the temporary side of the flash before committing the tested changes to
the permanent side, thereby committing the new updates.

</p>
<p>

Perform the following steps for the update:

</p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
<p>
    Save the level of the existing firmware before really updating. In
    ASM, in the system menu, click <span class="command"><strong>Service Aids ??? Service Processor
    Command Line</strong></span>, and run the following command:
</p>
<div class="informalexample"><pre class="screen">
     cupdcmd -f
</pre></div>
<p>
</p>
</li>
<li class="listitem">
<p>
    Download the .img file of the level of firmware to be updated to a
    location in the host filesystem. Refer to IBM Fix Central for downloading
    the image file.
</p>
<p>
    Verify the image downloaded by running the following command and
    save the output.
</p>
<div class="informalexample"><pre class="screen">
    $update_flash -v -f &lt;file_name.img&gt;
</pre></div>
<p>
</p>
</li>
<li class="listitem">
<p>
    Update the firmware by running the following command.
</p>
<div class="informalexample"><pre class="screen">
    $update_flash -f &lt;file_name.img&gt;
</pre></div>
<p>
</p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
<p>

 </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
    The command reboots the system and therefore, sessions if any,
    would be lost.
 </p></li>
<li class="listitem"><p>
    Do not reboot or switch off the system until it is back.
 </p></li>
</ul></div>
<p>

</p>
</td></tr>
</table></div>
</li>
<li class="listitem"><p>
    Verify the updated firmware level of the temporary side of the flash
    as in step 1. 
</p></li>
<li class="listitem">
<p>
    In case the update has to be reverted, the user can do so by running
    this command:
</p>
<div class="informalexample"><pre class="screen">
    $update_flash -r
</pre></div>
<p>
    Rejection would reject only the temporary side of the flash. 
    Therefore, the new level should be committed to the permanent side only
    after thorough testing of the new firmware.
</p>
<p>
    The new updated level can be committed to the permanent side of the
    flash by running the following command.
</p>
<div class="informalexample"><pre class="screen">
    $update_flash -c
</pre></div>
<p>
</p>
</li>
</ol></div>
<p>

</p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="idm959"></a>3.7.3. Updating KVM guest firmware (SLOF)</h3></div></div></div>
<p>

Slimline Open Firmware (SLOF) is an implementation of the IEEE 1275 
standard. 
It can be used as partition firmware for pSeries machines running on
QEMU or KVM.

</p>
<p>

The package qemu-slof is, in fact, a dependency of package 
qemu-system-ppc (which also provides the virtual package 
qemu-system-ppc64), and can be installed or updated via 
<span class="command"><strong>apt-get</strong></span> tool on Debian-based distros.
Like so:

</p>
<div class="informalexample"><pre class="screen">
# apt-get install qemu-slof
</pre></div>
<p>

SLOF can also be installed into rpm-based distribution systems, given 
the proper repository or rpm package. Additionally, the upstream source 
code is available at
<a class="ulink" href="http://github.com/leilihh/SLOF" target="_top">http://github.com/leilihh/SLOF</a>.

</p>
<p>

Thus, one can use a different SLOF file rather than the default, when
running <span class="command"><strong>qemu-system</strong></span>, by adding the command line
argument <strong class="userinput"><code>-bios &lt;slof_file&gt; </code></strong> when starting
qemu.

</p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="hardware-issues"></a>3.7.4. Hardware Issues to Watch Out For</h3></div></div></div>
<p><b>Display-visibility on OldWorld Powermacs. </b>
Some OldWorld Powermacs, most notably those with the <span class="quote">“<span class="quote">control</span>”</span>
display driver, may not reliably produce a colormap under Linux when the
display is configured for more than 256 colors. If you are experiencing such
issues with your display after rebooting (you can sometimes see data on
the monitor, but on other occasions cannot see anything) or, if the screen
turns black after booting the installer instead of showing you the user
interface, try changing your display settings under MacOS to use 256
colors instead of <span class="quote">“<span class="quote">thousands</span>”</span> or <span class="quote">“<span class="quote">millions</span>”</span>.

</p>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch03s06.html"><img src="images/prev.png" alt="Prev"></a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch03.html"><img src="images/up.png" alt="Up"></a></td>
<td width="40%" align="right"> <a accesskey="n" href="ch04.html"><img src="images/next.png" alt="Next"></a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">3.6. Pre-Partitioning for Multi-Boot Systems </td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"></a></td>
<td width="40%" align="right" valign="top"> Chapter 4. Obtaining System Installation Media</td>
</tr>
</table>
</div>
</body>
</html>
