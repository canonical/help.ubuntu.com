<!DOCTYPE html>
<html lang=zh-CN>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>用户管理</title>
<link rel="stylesheet" type="text/css" href="zh_CN.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body id="home">
<script src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">
        _uacct = "UA-1018242-8";
        urchinTracker();
      </script><script>
      function englishPageVersion() {
        var href = window.location.href;
        if (href.slice(-1) == "/") {
                window.location = "index.html.en";
        } else {
                window.location = href.replace(/\.html.*/, ".html.en");
        }
         return false;
      }
      function browserPreferredLanguage() {
        var href = window.location.href;
        if (href.slice(-1) == "/") {
                window.location = href;
        } else {
                window.location = href.replace(/\.html.*/, ".html");
        }
        return false;
      }
      </script><div id="container">
<div id="container-inner">
<div id="mothership"><ul>
<li><a href="https://partners.ubuntu.com">Partners</a></li>
<li><a href="https://www.ubuntu.com/support/community-support">Support</a></li>
<li><a href="https://community.ubuntu.com">Community</a></li>
<li><a href="https://www.ubuntu.com">Ubuntu.com</a></li>
</ul></div>
<div id="header">
<h1 id="ubuntu-header"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></h1>
<ul id="main-menu">
<li><a class="main-menu-item current" href="../../">Official Documentation</a></li>
<li><a href="https://help.ubuntu.com/community/CommunityHelpWiki">Community Help Wiki</a></li>
<li><a href="https://community.ubuntu.com/t/contribute/26">Contribute</a></li>
</ul>
</div>
<div id="menu-search"><div id="search-box">
<noscript><form action="https://www.google.com/cse" id="cse-search-box"><div>
<input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq"><input type="hidden" name="ie" value="UTF-8"><input type="text" name="q" size="21"><input type="submit" name="sa" value="Search">
</div></form></noscript>
<script>
                document.write('<form action="../../search.html" id="cse-search-box">');
                document.write('  <div>');
                document.write('    <input type="hidden" name="cof" value="FORID:9">');
                document.write('    <input type="hidden" name="cx" value="003883529982892832976:e2vwumte3fq">');
                document.write('    <input type="hidden" name="ie" value="UTF-8">');
                document.write('    <input type="text" name="q" size="21">');
                document.write('    <input type="submit" name="sa" value="Search">');
                document.write('  </div>');
                document.write('</form>');
              </script>
</div></div>
<div class="trails"><div class="trail">
<a href="../../18.04" class="trail">Ubuntu 18.04</a> » <a class="trail" href="index.html.zh-CN" title="Ubuntu 服务器指南">Ubuntu 服务器指南</a> » <a class="trail" href="security.html.zh-CN" title="安全性">安全性</a> » </div></div>
<div id="cwt-content" class="clearfix content-area"><div id="page">
<div id="content">
<div class="links nextlinks">
<a class="nextlinks-prev" href="security.html.zh-CN" title="安全性">上一页</a><a class="nextlinks-next" href="console-security.html.zh-CN" title="控制台安全">下一页</a>
</div>
<div class="hgroup"><h1 class="title">用户管理</h1></div>
<div class="region">
<div class="contents"><p class="para">用户管理是维护一个安全的系统中至关重要一个环节。在用户和权限管理方面跟不上步伐常常会导致其系统处在危险之中。因此，对于理解如何通过简单面有效的用户管理技术来保护你的服务器是必要重要的。</p></div>
<div class="links sectionlinks" role="navigation"><ul>
<li class="links"><a class="xref" href="user-management.html.zh-CN#where-is-root" title="Root 在哪里？">Root 在哪里？</a></li>
<li class="links"><a class="xref" href="user-management.html.zh-CN#adding-deleting-users" title="添加和删除用户">添加和删除用户</a></li>
<li class="links"><a class="xref" href="user-management.html.zh-CN#user-profile-security" title="用户资料安全">用户资料安全</a></li>
<li class="links"><a class="xref" href="user-management.html.zh-CN#password-policy" title="密码策略">密码策略</a></li>
<li class="links"><a class="xref" href="user-management.html.zh-CN#other-security-considerations" title="其它安全注意事项">其它安全注意事项</a></li>
</ul></div>
<div class="sect2 sect" id="where-is-root"><div class="inner">
<div class="hgroup"><h2 class="title">Root 在哪里？</h2></div>
<div class="region"><div class="contents">
<p class="para">Ubuntu的开发者们作出了一个出于真诚的决定，即在默认的Ubuntu安装中禁止root用户。这并不意味着root用户被删除了或者您的系统无法被管理了。root用户被赋予了一个没有实际口令与之对应的加密口令，因为设定之后Ubuntu并没有将那个随机口令记录下来。</p>
<p class="para">相反地，我们鼓励用户使用一个名为<span class="app application">sudo</span>的恒许来完成系统管理任务。<span class="app application">Sudo</span>允许用户使用自己设定的密码来管理而不需要root用户的密码。这个特性使得对各个雍和的各种权限的管理可以细化，并且将系统管理的部分活全部特权分给指定的用户。</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
		<p class="para">如果出于某些原因想启用root帐户，只要为它设置一个密码就可以了：</p>
		<div class="note" title="备注"><div class="inner"><div class="region"><div class="contents">
		<p class="para">
		Configurations with root passwords are not supported.
		</p>
		</div></div></div></div>
<div class="screen"><pre class="contents "><span class="cmd command">sudo passwd</span>
</pre></div>
		<p class="para">Sudo会让你输入你的密码，接着会让你为root设置新密码：</p>
<div class="screen"><pre class="contents "><span class="output computeroutput">[sudo] password for username:</span> <span class="input userinput">(输入你自己的密码)</span>
<span class="output computeroutput">Enter new UNIX password:</span> <span class="input userinput">(为 root 输入一个新密码)</span>
<span class="output computeroutput">Retype new UNIX password:</span> <span class="input userinput">(重复为 root 输入一个新密码)</span>
<span class="output computeroutput">passwd: password updated successfully</span>
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">
		To disable the root account password, use the following passwd syntax:
		</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo passwd -l root</span>
</pre></div>
		<p class="para">
        However, to disable the root account itself, use the following command:
		</p>
<div class="screen"><pre class="contents "><span class="cmd command">usermod --expiredate 1</span>
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">
		You should read more on <span class="app application">Sudo</span> by reading the man page:
		</p>
<div class="screen"><pre class="contents "><span class="cmd command">man sudo</span>
</pre></div>
		</li>
</ul></div>
<p class="para">
			By default, the initial user created by the Ubuntu installer is a member of the group "<span class="em emphasis">sudo</span>" which is added to the file <span class="file filename">/etc/sudoers</span> as an authorized sudo user. If you wish to give any other account full root access through <span class="app application">sudo</span>, simply add them to the <span class="em emphasis">sudo</span> group.
		</p>
</div></div>
</div></div>
<div class="sect2 sect" id="adding-deleting-users"><div class="inner">
<div class="hgroup"><h2 class="title">添加和删除用户</h2></div>
<div class="region"><div class="contents">
<p class="para">
	The process for managing local users and groups is straightforward and differs very little from most other GNU/Linux operating systems. Ubuntu and other Debian based distributions encourage the use of the "adduser" package for account management.
	</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
		<p class="para">
		To add a user account, use the following syntax, and follow the prompts to give the account a password and identifiable characteristics, such as a full name, phone number, etc.
		</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo adduser username</span>
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">要删除一个用户及其主要组别，使用如下命令：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo deluser username</span>
</pre></div>
		<p class="para">删除一个帐号并不会同时删除其相应的home文件夹。要你自己决定性是手动把它删掉还是根据你的保留政策而将其留下来。</p>
		<p class="para">请记住，如果不采取预防措施，将来添加的任何与以前拥有者相同UID/GID的用户都能够进入到此文件夹。</p>
		<p class="para">你可以将这些UID/GID改成比较合适的值，如根帐户，或许将文件夹也移至新位置以避免将来发生的冲突。</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo chown -R root:root /home/username/</span>
<span class="cmd command">sudo mkdir /home/archived_users/</span>
<span class="cmd command">sudo mv /home/username /home/archived_users/</span>
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">要暂时锁住或解锁一个用户帐户，请相应地使用如下命令语句：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo passwd -l 用户名</span>
<span class="cmd command">sudo passwd -u 用户名</span>
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">要添加或删除一个个性化组，请相应地使用如下命令语句：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo addgroup groupname</span>
<span class="cmd command">sudo delgroup 组名称</span>
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">要将一个用户加入到某个组，请使用如下命令语句：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo adduser username groupname</span>
</pre></div>
		</li>
</ul></div>
</div></div>
</div></div>
<div class="sect2 sect" id="user-profile-security"><div class="inner">
<div class="hgroup"><h2 class="title">用户资料安全</h2></div>
<div class="region"><div class="contents">
<p class="para">
	When a new user is created, the adduser utility creates a brand new home directory named <span class="file filename">/home/username</span>. The default profile is modeled after the contents found in the directory of <span class="file filename">/etc/skel</span>, which includes all profile basics.  
	</p>
<p class="para">如果你的服务器是供多人使用，那你就应该注意一下用户主目录的权限问题，以保安全。默认情况下，Ubuntu用户的主目录在创建时是被赋予写/执行权限。这意味着所有的用户都能够进入并浏览到其他用户的主目录里的内容。这对你的现状可能并不适用。</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
		<p class="para">
		To verify your current user home directory permissions, use the following syntax:
		</p>
<div class="screen"><pre class="contents "><span class="cmd command">ls -ld /home/username</span>
</pre></div>
		<p class="para">The following output shows that the directory <span class="file filename">/home/username</span> has world-readable permissions:
		</p>
<div class="screen"><pre class="contents "><span class="output computeroutput">drwxr-xr-x  2 username username    4096 2007-10-02 20:03 username</span>
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">
		You can remove the world readable-permissions using the following syntax:
		</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo chmod 0750 /home/username</span>
</pre></div>
		<div class="note" title="备注"><div class="inner"><div class="region"><div class="contents">
		<p class="para">有些人喜欢不分青红皂白地对子文件夹和文件使用递归选项(-R)，其实这并没有必要，有时甚至会产生不必要的麻烦。仅使用父目录会阻止任何对父目录下的非经授权的闯入。</p>
		</div></div></div></div>
		<p class="para">解决这件事一个更高效的方法是在创建一个新的用户主目录时修改<span class="app application">adduser</span>的公共默认权限。恰当地编辑<span class="file filename">/etc/adduser.conf</span>文件和修改<span class="code varname">DIR_MODE</span>变量，这样新用户目录就会接受正确的权限。</p>
<div class="code"><pre class="contents ">DIR_MODE=0750
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">在用了之前提到的技术更改过目录的权限后，使用如下命令语句来验证结果：</p>
<div class="screen"><pre class="contents "><span class="cmd command">ls -ld /home/username</span>
</pre></div>
		<p class="para">The results below show that world-readable permissions have been removed:
		</p>
<div class="screen"><pre class="contents "><span class="output computeroutput">drwxr-x---   2 username username    4096 2007-10-02 20:03 username</span>
</pre></div>
		</li>
</ul></div>
</div></div>
</div></div>
<div class="sect2 sect" id="password-policy"><div class="inner">
<div class="hgroup"><h2 class="title">密码策略</h2></div>
<div class="region">
<div class="contents"><p class="para">在您的安全状态中一个强大的密码策略是其中一个最重要的方面。许多成功的安全漏洞涉及穷举和字典攻击弱密码。如果您打算提供任何形式的远程访问涉及您当地的密码系统，确保您充分解决最低密码复杂性的要求，密码最长寿命，和频繁发生的审计您的系统验证。</p></div>
<div class="sect3 sect" id="minimum-password-length"><div class="inner">
<div class="hgroup"><h3 class="title">最小密码长度</h3></div>
<div class="region"><div class="contents">
<p class="para">
	By default, Ubuntu requires a minimum password length of 6 characters, as well as some basic entropy checks. These values are controlled in the file <span class="file filename">/etc/pam.d/common-password</span>, which is outlined below.
	</p>
<div class="code"><pre class="contents ">password        [success=1 default=ignore]      pam_unix.so obscure sha512
</pre></div>
<p class="para">
If you would like to adjust the minimum length to 8 characters, change the appropriate variable to min=8. The modification is outlined below.
	</p>
<div class="code"><pre class="contents ">password        [success=1 default=ignore]      pam_unix.so obscure sha512 minlen=8
</pre></div>
<div class="note" title="备注"><div class="inner"><div class="region"><div class="contents">
                <p class="para">
                Basic password entropy checks and minimum length rules do not apply to the administrator using sudo level commands to setup a new user.
                </p>
                </div></div></div></div>
</div></div>
</div></div>
<div class="sect3 sect" id="password-expiration"><div class="inner">
<div class="hgroup"><h3 class="title">密码过期</h3></div>
<div class="region"><div class="contents">
<p class="para">当创建用户帐户时，你应该使用最短和最长密码期效来强迫用户在密码过期时改变他们的密码。</p>
<div class="list itemizedlist"><ul class="list itemizedlist">
<li class="list itemizedlist">
		<p class="para">要简易地查看某用户的当前状态，使用如下命令语句：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo chage -l username</span>
</pre></div>
		<p class="para">下面输出显示了有关这个用户帐户的有趣事实，即其未应用任何策略：</p>
<div class="screen"><pre class="contents "><span class="output computeroutput">Last password change                                    : Jan 20, 2015
Password expires                                        : never
Password inactive                                       : never
Account expires                                         : never
Minimum number of days between password change          : 0
Maximum number of days between password change          : 99999
Number of days of warning before password expires       : 7</span>
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">要设置其中任何一个值，使用以下语法，并跟随交互的提示：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo chage username</span>
</pre></div>
		<p class="para">
		The following is also an example of how you can manually change the explicit expiration date (-E) to 01/31/2015, minimum password age (-m) of 5 days, maximum password  age (-M) of 90 days, inactivity period (-I) of 5 days after password expiration, and a warning time period (-W) of 14 days before password expiration:
		</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo chage -E 01/31/2015 -m 5 -M 90 -I 30 -W 14 username</span>
</pre></div>
		</li>
<li class="list itemizedlist">
		<p class="para">要确认更改，请使用前面提到的相同命令语句：</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo chage -l username</span>
</pre></div>
		<p class="para">以下的输出显示对帐号的新策略已建立：</p>
<div class="screen"><pre class="contents "><span class="output computeroutput">Last password change                                    : Jan 20, 2015
Password expires                                        : Apr 19, 2015
Password inactive                                       : May 19, 2015
Account expires                                         : Jan 31, 2015
Minimum number of days between password change          : 5
Maximum number of days between password change          : 90
Number of days of warning before password expires       : 14</span>
</pre></div>
		</li>
</ul></div>
</div></div>
</div></div>
</div>
</div></div>
<div class="sect2 sect" id="other-security-considerations"><div class="inner">
<div class="hgroup"><h2 class="title">其它安全注意事项</h2></div>
<div class="region">
<div class="contents"><p class="para">许多程序使用交替谁机制，即使是有经验的系统管理员也很容易对其忽视。因此，理解并控制用户获得认证和并进入你的服务器上的服务和程序就很重要。</p></div>
<div class="sect3 sect" id="ssh-access-by-disabled-users"><div class="inner">
<div class="hgroup"><h3 class="title">已禁用用户试图通过SSH连入</h3></div>
<div class="region"><div class="contents">
<p class="para">
	Simply disabling/locking a user account will not prevent a user from logging into your server remotely if they have previously set up RSA public key authentication. They will still be able to gain shell access to the server, without the need for any password. Remember to check the users home directory for files that will allow for this type of authenticated SSH access, e.g. <span class="file filename">/home/username/.ssh/authorized_keys</span>.
	</p>
<p class="para">将用户home文件夹下面的目录<span class="file filename">.ssh/</span>删除或改名，以防止将来自动获得SSH认证权限。</p>
<p class="para">一定要检查禁用用户创建的SSH连接，因为他们可能会有存在的入站或出站连接。发现一个取消一个。</p>
<div class="screen"><pre class="contents "><span class="cmd command">who | grep username</span>  (to get the pts/# terminal)
<span class="cmd command">sudo pkill -f pts/#</span>
</pre></div>
<p class="para">限制只有适当的用户拥有SSH的读取权限。例如，您可以生成一个叫做"sshlogin"的用户组，然后把和文件<span class="file filename">/etc/ssh/sshd_config</span>中的<span class="code varname">AllowGroups</span>变量关联起来。</p>
<div class="code"><pre class="contents ">允许 ssh 组登陆
</pre></div>
<p class="para">然后将你允许的SSH用户添加到"sshlogin"组，并重启SSH服务。</p>
<div class="screen"><pre class="contents "><span class="cmd command">sudo adduser 用户名 sshlogin</span>
<span class="cmd command">sudo systemctl restart sshd.service</span>
</pre></div>
</div></div>
</div></div>
<div class="sect3 sect" id="external-db-auth"><div class="inner">
<div class="hgroup"><h3 class="title">外部用户数据库认证</h3></div>
<div class="region"><div class="contents"><p class="para">
	Most enterprise networks require centralized authentication and access controls for all system resources. If you have configured your server to authenticate users against external databases, be sure to disable the user accounts both externally and locally. This way you ensure that local fallback authentication is not possible.
	</p></div></div>
</div></div>
</div>
</div></div>
</div>
<div class="links nextlinks">
<a class="nextlinks-prev" href="security.html.zh-CN" title="安全性">上一页</a><a class="nextlinks-next" href="console-security.html.zh-CN" title="控制台安全">下一页</a>
</div>
<div class="clear"></div>
</div>
<div id="pagebottom"></div>
</div></div>
</div>
<div id="footer">
<p style="padding-bottom: 0.4em">You can choose the <b>displayed language</b> by adding a language suffix to the web address
          so it ends with e.g. <tt>.html.en</tt> or <tt>.html.de</tt>.<br>
          If the web address has no language suffix, the preferred language specified in your web browser's settings is used. For your convenience:<br>
          [ <a title="English page version" href="#" onClick="englishPageVersion();">Change to English Language</a> | 
          <a title="Language selected by browser" href="#" onClick="browserPreferredLanguage()">Change to Browser's Preferred Language</a> ]</p>
<p>The material in this document is available under a free license, see <a href="../../legal.html">Legal</a> for details.<br>
          For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>.
          To report errors in this serverguide documentation, <a href="https://bugs.launchpad.net/serverguide">file a bug report</a>.</p>
</div>
</div>
</body>
</html>
